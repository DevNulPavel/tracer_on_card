<!DOCTYPE html>
<!-- saved from url=(0056)https://tproger.ru/translations/business-card-raytracer/ -->
<html lang="ru-RU" class=" js cssanimations"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"> <script async="" data-rocketsrc="https://www.google-analytics.com/analytics.js" data-rocketoptimized="true"></script><script type="text/javascript" async="" data-rocketsrc="https://mc.yandex.ru/metrika/watch.js" data-rocketoptimized="true"></script><script data-rocketsrc="https://pagead2.googlesyndication.com/pub-config/r20160601/ca-pub-9189593931769509.js" data-rocketoptimized="true"></script><script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:1473426059,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"92d64dd7d6a0ef12bfe7c5f61be4600d",petok:"172938e5fb489fa0d5c44ca8b33548baeefd41aa-1474123388-3600",zone:"tproger.ru",rocket:"a",apps:0,sha2test:0}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=0489c402f5/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="./Трассировщик лучей на визитке _ Типичный программист_files/cloudflare.min.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_10d95ef4885" onload="CloudFlare.__cfjs_block_10d95ef4885_load()" onerror="CloudFlare.__cfjs_block_10d95ef4885_error()" onreadystatechange="CloudFlare.__cfjs_block_10d95ef4885_readystatechange()" type="text/javascript" src="./Трассировщик лучей на визитке _ Типичный программист_files/rocket.js"></script>
<link type="text/css" media="all" href="./Трассировщик лучей на визитке _ Типичный программист_files/autoptimize_5ae6175e9658b8f382bcaee23abbe38f.css" rel="stylesheet"><title>Трассировщик лучей на визитке / Типичный&nbsp;программист</title><meta name="description" content="Рассказывает Фабиен Санглард, автор блога fabiensanglard.net Недавно в интернете я наткнулся на трассировщик лучей на визитке Пола Гекберта. Для тех, кто не в курсе: это очень известная задача, изначально предложенная Полом Гекбертом 4-ого мая 1984 на comp.graphics. Ее суть в том, чтобы написать демонстрацию метода бросания лучей, которая бы… умещалась на визитной карточке (больше об…"><link rel="profile" href="http://gmpg.org/xfn/11"><link rel="pingback" href="https://tproger.ru/xmlrpc.php"><!--[if lt IE 9]><script src="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/html5.js" type="text/javascript"></script><![endif]--><link rel="manifest" href="https://tproger.ru/wp-content/plugins/onesignal-free-web-push-notifications/sdk_files/manifest.json.php?gcm_sender_id=338046998357"><script data-rocketsrc="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async="" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">/*<![CDATA[*/var OneSignal=OneSignal||[];OneSignal.push(function(){OneSignal.SERVICE_WORKER_UPDATER_PATH="OneSignalSDKUpdaterWorker.js.php";OneSignal.SERVICE_WORKER_PATH="OneSignalSDKWorker.js.php";OneSignal.SERVICE_WORKER_PARAM={scope:'/'};OneSignal.setDefaultNotificationUrl("https://tproger.ru");var oneSignal_options={};oneSignal_options['wordpress']=true;oneSignal_options['appId']='ef084fe2-45b1-4d59-9d24-c95f15a4357a';oneSignal_options['autoRegister']=true;oneSignal_options['welcomeNotification']={};oneSignal_options['welcomeNotification']['title']="";oneSignal_options['welcomeNotification']['message']="Ура! Вы подписаны на обновления.";oneSignal_options['path']="https://tproger.ru/wp-content/plugins/onesignal-free-web-push-notifications/sdk_files/";oneSignal_options['safari_web_id']="web.onesignal.auto.40e188d7-5f7a-4af3-8ac5-05427adc97a7";oneSignal_options['persistNotification']=false;oneSignal_options['notifyButton']={};oneSignal_options['notifyButton']['enable']=true;oneSignal_options['notifyButton']['position']='bottom-right';oneSignal_options['notifyButton']['theme']='inverse';oneSignal_options['notifyButton']['size']='medium';oneSignal_options['notifyButton']['prenotify']=true;oneSignal_options['notifyButton']['showCredit']=false;oneSignal_options['notifyButton']['text']={};oneSignal_options['notifyButton']['text']['message.prenotify']='Нажмите, чтобы подписаться на обновления';oneSignal_options['notifyButton']['text']['tip.state.unsubscribed']='Подписаться на обновления';oneSignal_options['notifyButton']['text']['tip.state.subscribed']='Вы подписаны на обновления';oneSignal_options['notifyButton']['text']['tip.state.blocked']='Уведомления об обновлениях заблокированы';oneSignal_options['notifyButton']['text']['message.action.subscribed']='Спасибо, что подписались!';oneSignal_options['notifyButton']['text']['message.action.resubscribed']='Вы снова подписаны на обновления';oneSignal_options['notifyButton']['text']['message.action.unsubscribed']='Вы больше не будете получать уведомления об обновлениях';oneSignal_options['notifyButton']['text']['dialog.main.title']='Push-уведомления';oneSignal_options['notifyButton']['text']['dialog.main.button.subscribe']='Подписаться';oneSignal_options['notifyButton']['text']['dialog.main.button.unsubscribe']='Отписаться';oneSignal_options['notifyButton']['text']['dialog.blocked.title']='Уведомления заблокированы';oneSignal_options['notifyButton']['text']['dialog.blocked.message']='Следуйте инструкции на картинке, чтобы разрешить уведомления';oneSignal_options['notifyButton']['colors']={};oneSignal_options['notifyButton']['colors']['circle.background']='white';oneSignal_options['notifyButton']['colors']['circle.foreground']='#0a9993';oneSignal_options['notifyButton']['colors']['badge.background']='#373435';oneSignal_options['notifyButton']['colors']['badge.foreground']='white';oneSignal_options['notifyButton']['colors']['badge.bordercolor']='white';oneSignal_options['notifyButton']['colors']['pulse.color']='#80c7b0';oneSignal_options['notifyButton']['colors']['dialog.button.background']='#80c7b0';oneSignal_options['notifyButton']['colors']['dialog.button.background.hovering']='#0a9993';oneSignal_options['notifyButton']['colors']['dialog.button.background.active']='#09837e';oneSignal_options['notifyButton']['colors']['dialog.button.foreground']='white';OneSignal.init(oneSignal_options);});function documentInitOneSignal(){var oneSignal_elements=document.getElementsByClassName("OneSignal-prompt");var oneSignalLinkClickHandler=function(event){OneSignal.push(['registerForPushNotifications']);event.preventDefault();};for(var i=0;i<oneSignal_elements.length;i++)
oneSignal_elements[i].addEventListener('click',oneSignalLinkClickHandler,false);}
if(document.readyState==='complete'){documentInitOneSignal();}
else{window.addEventListener("load",function(event){documentInitOneSignal();});}/*]]>*/</script><link rel="dns-prefetch" href="https://pagead2.googlesyndication.com/"><link rel="dns-prefetch" href="https://fonts.googleapis.com/"><link rel="dns-prefetch" href="https://s.w.org/"><link rel="alternate" type="application/rss+xml" title="Типичный программист » Лента" href="https://tproger.ru/feed/"><link rel="alternate" type="application/rss+xml" title="Типичный программист » Лента комментариев" href="https://tproger.ru/comments/feed/"><link rel="alternate" type="application/rss+xml" title="Типичный программист » Лента комментариев к «Трассировщик лучей на визитке»" href="https://tproger.ru/translations/business-card-raytracer/feed/"><script type="text/rocketscript" data-rocketoptimized="true">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/tproger.ru\/wp-includes\/js\/wp-emoji-release.min.js?v=18"}};!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><link rel="stylesheet" id="bluth-googlefonts-css" onload="(function(a){window.CloudFlare &amp;&amp; window.CloudFlare.push(function(b){b([&quot;cloudflare/rocket&quot;],function(c){c.push(function(){(function(){window.googleFontIsLoaded = true;}).call(a)})})})})(this);" href="./Трассировщик лучей на визитке _ Типичный программист_files/css" type="text/css" media="all"><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-includes/js/jquery/jquery.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-includes/js/jquery/jquery-migrate.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/fd-footnotes/fdfootnotes.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/mega-anchor/imagesloaded.pkgd.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/mega-anchor/mega-anchor.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var pvcArgsFrontend={"ajaxURL":"https:\/\/tproger.ru\/wp-admin\/admin-ajax.php","postID":"7674","nonce":"e58065643e","postType":"post"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/post-views-counter/js/frontend.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/texperts/resources/js/vote_for_answer.ajax.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/texperts/resources/js/display_answer_rating.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/texperts/resources/js/get_articles_with_expert.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/top-bar/js/jquery.cookie.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var tpbr_settings={"fixed":"notfixed","message":"\u042d\u0442\u043e\u0439 \u043d\u043e\u0447\u044c\u044e (\u0441 22 \u043d\u0430 23 \u0438\u044e\u043b\u044f) \u0441\u0430\u0439\u0442 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u0435 \u0441 23:00 \u0434\u043e 2:30 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435\u043c \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0440\u0430\u0431\u043e\u0442.","status":"inactive","yn_button":"nobutton","color":"#E96959","button_text":"\u041f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c","button_url":"http:\/\/narod.premiaruneta.ru\/","close_image":null,"is_admin_bar":"no"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/top-bar/js/tpbr_front.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/citation-widget/js/main.js?v=18" data-rocketoptimized="true"></script><link rel="https://api.w.org/" href="https://tproger.ru/wp-json/"><link rel="canonical" href="https://tproger.ru/translations/business-card-raytracer/"><link rel="shortlink" href="https://tproger.ru/?p=7674"><link rel="alternate" type="application/json+oembed" href="https://tproger.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftproger.ru%2Ftranslations%2Fbusiness-card-raytracer%2F"><link rel="alternate" type="text/xml+oembed" href="https://tproger.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftproger.ru%2Ftranslations%2Fbusiness-card-raytracer%2F&amp;format=xml"><script type="text/rocketscript" data-rocketsrc="//vk.com/js/api/openapi.js?117" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">VK.init({apiId:5104638,onlyWidgets:true});</script><script async="" data-rocketsrc="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-9189593931769509",enable_page_level_ads:true});</script><script type="text/rocketscript" data-rocketoptimized="true">var internalURLs=['https://tproger.ru','https://tproger2.azureedge.net/wp-content/uploads'];</script><link rel="Shortcut Icon" type="image/x-icon" href="https://tproger2.azureedge.net/wp-content/uploads/2014/12/favicon1.png"><meta property="og:site_name" content="Типичный программист"><meta property="og:title" content="  Трассировщик лучей на визитке"><meta property="og:image" content="https://tproger2.azureedge.net/wp-content/uploads/2015/07/Untitled7.png"><meta property="og:description" content="Рассказывает Фабиен Санглард, автор блога fabiensanglard.net Недавно в интернете я наткнулся на трассировщик лучей на визитке Пола Гекберта. Для тех, кто н"><meta property="og:type" content="article"><meta property="og:url" content="https://tproger.ru/translations/business-card-raytracer/"><style type="text/css">/*!
* CleanSlate
*   github.com/premasagar/cleanslate
*
*/.onesignal-reset,.onesignal-reset a,.onesignal-reset abbr,.onesignal-reset acronym,.onesignal-reset address,.onesignal-reset applet,.onesignal-reset area,.onesignal-reset article,.onesignal-reset aside,.onesignal-reset audio,.onesignal-reset b,.onesignal-reset big,.onesignal-reset blockquote,.onesignal-reset button,.onesignal-reset canvas,.onesignal-reset caption,.onesignal-reset cite,.onesignal-reset code,.onesignal-reset col,.onesignal-reset colgroup,.onesignal-reset datalist,.onesignal-reset dd,.onesignal-reset del,.onesignal-reset dfn,.onesignal-reset div,.onesignal-reset dl,.onesignal-reset dt,.onesignal-reset em,.onesignal-reset fieldset,.onesignal-reset figcaption,.onesignal-reset figure,.onesignal-reset footer,.onesignal-reset form,.onesignal-reset h1,.onesignal-reset h2,.onesignal-reset h3,.onesignal-reset h4,.onesignal-reset h5,.onesignal-reset h6,.onesignal-reset header,.onesignal-reset hr,.onesignal-reset i,.onesignal-reset iframe,.onesignal-reset img,.onesignal-reset input,.onesignal-reset ins,.onesignal-reset kbd,.onesignal-reset label,.onesignal-reset legend,.onesignal-reset li,.onesignal-reset main,.onesignal-reset map,.onesignal-reset mark,.onesignal-reset menu,.onesignal-reset meta,.onesignal-reset nav,.onesignal-reset object,.onesignal-reset ol,.onesignal-reset optgroup,.onesignal-reset option,.onesignal-reset output,.onesignal-reset p,.onesignal-reset pre,.onesignal-reset progress,.onesignal-reset q,.onesignal-reset samp,.onesignal-reset section,.onesignal-reset select,.onesignal-reset small,.onesignal-reset span,.onesignal-reset strike,.onesignal-reset strong,.onesignal-reset sub,.onesignal-reset summary,.onesignal-reset sup,.onesignal-reset table,.onesignal-reset tbody,.onesignal-reset td,.onesignal-reset textarea,.onesignal-reset tfoot,.onesignal-reset th,.onesignal-reset thead,.onesignal-reset time,.onesignal-reset tr,.onesignal-reset tt,.onesignal-reset ul,.onesignal-reset var,.onesignal-reset video{background-attachment:scroll;background-color:transparent;background-image:none;background-position:0 0;background-repeat:repeat;border-color:#000;border:medium none currentColor;bottom:auto;clear:none;clip:auto;color:inherit;counter-increment:none;counter-reset:none;cursor:auto;direction:inherit;display:inline;float:none;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:normal;font-weight:inherit;height:auto;left:auto;letter-spacing:normal;line-height:inherit;list-style-type:inherit;list-style-position:outside;list-style-image:none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;outline:medium none invert;overflow:visible;padding:0;position:static;quotes:"" "";right:auto;table-layout:auto;text-align:inherit;text-decoration:inherit;text-indent:0;text-transform:none;top:auto;unicode-bidi:normal;vertical-align:baseline;visibility:inherit;white-space:normal;width:auto;word-spacing:normal;z-index:auto;background-origin:padding-box;background-clip:border-box;background-size:auto;-o-border-image:none;border-image:none;border-radius:0;box-shadow:none;box-sizing:content-box;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none #000;-moz-column-rule:medium none #000;column-rule:medium none #000;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;-webkit-font-feature-settings:normal;font-feature-settings:normal;overflow-x:visible;overflow-y:visible;-webkit-hyphens:manual;-moz-hyphens:manual;-ms-hyphens:manual;hyphens:manual;-webkit-perspective:none;-ms-perspective:none;-o-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;-ms-perspective-origin:50% 50%;-o-perspective-origin:50% 50%;perspective-origin:50% 50%;-webkit-backface-visibility:visible;backface-visibility:visible;text-shadow:none;-webkit-transition:all 0s ease 0s;transition:all 0s ease 0s;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform-style:flat;transform-style:flat;word-break:normal}.onesignal-reset,.onesignal-reset address,.onesignal-reset article,.onesignal-reset audio,.onesignal-reset blockquote,.onesignal-reset caption,.onesignal-reset colgroup,.onesignal-reset dd,.onesignal-reset dialog,.onesignal-reset div,.onesignal-reset dl,.onesignal-reset dt,.onesignal-reset fieldset,.onesignal-reset figure,.onesignal-reset footer,.onesignal-reset form,.onesignal-reset h1,.onesignal-reset h2,.onesignal-reset h3,.onesignal-reset h4,.onesignal-reset h5,.onesignal-reset h6,.onesignal-reset header,.onesignal-reset hgroup,.onesignal-reset hr,.onesignal-reset main,.onesignal-reset menu,.onesignal-reset nav,.onesignal-reset ol,.onesignal-reset option,.onesignal-reset p,.onesignal-reset pre,.onesignal-reset progress,.onesignal-reset section,.onesignal-reset summary,.onesignal-reset ul,.onesignal-reset video{display:block}.onesignal-reset h1,.onesignal-reset h2,.onesignal-reset h3,.onesignal-reset h4,.onesignal-reset h5,.onesignal-reset h6{font-weight:700}.onesignal-reset h1{font-size:2em;padding:.67em 0}.onesignal-reset h2{font-size:1.5em;padding:.83em 0}.onesignal-reset h3{font-size:1.17em;padding:.83em 0}.onesignal-reset h4{font-size:1em}.onesignal-reset h5{font-size:.83em}.onesignal-reset p{margin:1em 0}.onesignal-reset table{display:table}.onesignal-reset thead{display:table-header-group}.onesignal-reset tbody{display:table-row-group}.onesignal-reset tfoot{display:table-footer-group}.onesignal-reset tr{display:table-row}.onesignal-reset td,.onesignal-reset th{display:table-cell;padding:2px}.onesignal-reset ol,.onesignal-reset ul{margin:1em 0}.onesignal-reset ol li,.onesignal-reset ol ol li,.onesignal-reset ol ol ol li,.onesignal-reset ol ol ul li,.onesignal-reset ol ul ul li,.onesignal-reset ul li,.onesignal-reset ul ol ol li,.onesignal-reset ul ul li,.onesignal-reset ul ul ol li,.onesignal-reset ul ul ul li{list-style-position:inside;margin-top:.08em}.onesignal-reset ol ol,.onesignal-reset ol ol ol,.onesignal-reset ol ol ul,.onesignal-reset ol ul,.onesignal-reset ol ul ul,.onesignal-reset ul ol,.onesignal-reset ul ol ol,.onesignal-reset ul ul,.onesignal-reset ul ul ol,.onesignal-reset ul ul ul{padding-left:40px;margin:0}.onesignal-reset nav ol,.onesignal-reset nav ul{list-style-type:none}.onesignal-reset menu,.onesignal-reset ul{list-style-type:disc}.onesignal-reset ol{list-style-type:decimal}.onesignal-reset menu menu,.onesignal-reset menu ul,.onesignal-reset ol menu,.onesignal-reset ol ul,.onesignal-reset ul menu,.onesignal-reset ul ul{list-style-type:circle}.onesignal-reset menu menu menu,.onesignal-reset menu menu ul,.onesignal-reset menu ol menu,.onesignal-reset menu ol ul,.onesignal-reset menu ul menu,.onesignal-reset menu ul ul,.onesignal-reset ol menu menu,.onesignal-reset ol menu ul,.onesignal-reset ol ol menu,.onesignal-reset ol ol ul,.onesignal-reset ol ul menu,.onesignal-reset ol ul ul,.onesignal-reset ul menu menu,.onesignal-reset ul menu ul,.onesignal-reset ul ol menu,.onesignal-reset ul ol ul,.onesignal-reset ul ul menu,.onesignal-reset ul ul ul{list-style-type:square}.onesignal-reset li{display:list-item;min-height:auto;min-width:auto;padding-left:20px}.onesignal-reset strong{font-weight:700}.onesignal-reset em{font-style:italic}.onesignal-reset code,.onesignal-reset kbd,.onesignal-reset pre,.onesignal-reset samp{font-family:monospace}.onesignal-reset a{color:blue;text-decoration:underline}.onesignal-reset a:visited{color:#529}.onesignal-reset a,.onesignal-reset a *,.onesignal-reset input[type=checkbox],.onesignal-reset input[type=radio],.onesignal-reset input[type=submit],.onesignal-reset select{cursor:pointer}.onesignal-reset button,.onesignal-reset input[type=submit]{text-align:center;padding:2px 6px 3px;border-radius:4px;text-decoration:none;font-family:arial,helvetica,sans-serif;font-size:small;-webkit-appearance:push-button;color:buttontext;border:1px solid #a6a6a6;background:#d3d3d3;background:#fff;background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fff),color-stop(100%,#ddd),color-stop(100%,#d1d1d1),color-stop(100%,#ddd));background:-webkit-linear-gradient(top,#fff,#ddd 100%,#d1d1d1 0,#ddd 0);background:linear-gradient(180deg,#fff 0,#ddd 100%,#d1d1d1 0,#ddd 0);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff',endColorstr='#dddddd',GradientType=0);-o-box-shadow:1px 1px 0 #eee;box-shadow:1px 1px 0 #eee;outline:initial}.onesignal-reset button{padding:1px 6px 2px;margin-right:5px}.onesignal-reset input[type=hidden]{display:none}.onesignal-reset textarea{-webkit-appearance:textarea;background:#fff;padding:2px;margin-left:4px;word-wrap:break-word;white-space:pre-wrap;font-size:11px;font-family:arial,helvetica,sans-serif;line-height:13px;resize:both}.onesignal-reset input,.onesignal-reset select,.onesignal-reset textarea{border:1px solid #ccc}.onesignal-reset select{font-size:11px;font-family:helvetica,arial,sans-serif;display:inline-block}.onesignal-reset input:focus,.onesignal-reset textarea:focus{outline:5px auto -webkit-focus-ring-color;outline:initial}.onesignal-reset input[type=text]{background:#fff;padding:1px;font-family:initial;font-size:small}.onesignal-reset input[type=checkbox],.onesignal-reset input[type=radio]{border:1px solid #2b2b2b;border-radius:4px;outline:intial}.onesignal-reset input[type=radio]{margin:2px 2px 3px}.onesignal-reset button:active,.onesignal-reset input[type=submit]:active{background:#3b679e;background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#3b679e),color-stop(50%,#2b88d9),color-stop(51%,#207cca),color-stop(100%,#7db9e8));background:-webkit-linear-gradient(top,#3b679e,#2b88d9 50%,#207cca 51%,#7db9e8);background:linear-gradient(180deg,#3b679e 0,#2b88d9 50%,#207cca 51%,#7db9e8);border-color:#5259b0}.onesignal-reset abbr[title],.onesignal-reset acronym[title],.onesignal-reset dfn[title]{cursor:help;border-bottom-width:1px;border-bottom-style:dotted}.onesignal-reset ins{background-color:#ff9;color:#000}.onesignal-reset del{text-decoration:line-through}.onesignal-reset blockquote,.onesignal-reset q{quotes:none}.onesignal-reset blockquote:after,.onesignal-reset blockquote:before,.onesignal-reset li:after,.onesignal-reset li:before,.onesignal-reset q:after,.onesignal-reset q:before{content:""}.onesignal-reset input,.onesignal-reset select{vertical-align:middle}.onesignal-reset table{border-collapse:collapse;border-spacing:0}.onesignal-reset hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0}.onesignal-reset [dir=rtl]{direction:rtl}.onesignal-reset mark{background-color:#ff9;color:#000;font-style:italic;font-weight:700}.onesignal-reset menu{padding-left:40px;padding-top:8px}.onesignal-reset [hidden],.onesignal-reset template{display:none}.onesignal-reset abbr[title]{border-bottom:1px dotted}.onesignal-reset sub,.onesignal-reset sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.onesignal-reset sup{top:-.5em}.onesignal-reset sub{bottom:-.25em}.onesignal-reset img{border:0}.onesignal-reset figure{margin:0}.onesignal-reset textarea{overflow:auto;vertical-align:top}.onesignal-reset{font-size:medium;line-height:1;direction:ltr;text-align:left;text-align:start;font-family:Times New Roman,Times,serif;color:#000;font-style:normal;font-weight:400;text-decoration:none;list-style-type:disc}.onesignal-reset pre{white-space:pre}#onesignal-bell-container.onesignal-reset{z-index:2147483000;position:fixed}#onesignal-bell-container.onesignal-reset.onesignal-bell-container-bottom-left{bottom:0;left:0}#onesignal-bell-container.onesignal-reset.onesignal-bell-container-bottom-right{bottom:0;right:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:initial;position:absolute;z-index:2147483000;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;-webkit-transform:scale(.01) translateZ(0);transform:scale(.01) translateZ(0);opacity:0;-webkit-transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left{bottom:20px;left:20px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-sm{-webkit-transform-origin:center center;transform-origin:center center;width:32px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-sm .onesignal-bell-launcher-message{left:42px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog{bottom:39px;left:0;-webkit-transform-origin:left bottom;transform-origin:left bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:before{left:5px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:after{left:7px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-md{-webkit-transform-origin:center center;transform-origin:center center;width:48px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-md .onesignal-bell-launcher-message{left:61px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog{bottom:58px;left:0;-webkit-transform-origin:left bottom;transform-origin:left bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:before{left:12px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:after{left:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-lg{-webkit-transform-origin:center center;transform-origin:center center;width:64px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-lg .onesignal-bell-launcher-message{left:81px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog{bottom:78px;left:0;-webkit-transform-origin:left bottom;transform-origin:left bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:before{left:18px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:after{left:20px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left .onesignal-bell-launcher-badge{left:4px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left .onesignal-bell-launcher-message{-webkit-transform-origin:left center;transform-origin:left center}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left .onesignal-bell-launcher-message:after{right:100%;border-right-color:#000}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-left .onesignal-bell-launcher-button{left:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right{bottom:20px;right:20px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-sm{-webkit-transform-origin:center center;transform-origin:center center;width:32px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-sm .onesignal-bell-launcher-message{right:42px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog{bottom:39px;right:0;-webkit-transform-origin:right bottom;transform-origin:right bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:before{right:5px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:after{right:7px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-md{-webkit-transform-origin:center center;transform-origin:center center;width:48px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-md .onesignal-bell-launcher-message{right:61px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog{bottom:58px;right:0;-webkit-transform-origin:right bottom;transform-origin:right bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:before{right:12px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:after{right:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-lg{-webkit-transform-origin:center center;transform-origin:center center;width:64px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-lg .onesignal-bell-launcher-message{right:81px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog{bottom:78px;right:0;-webkit-transform-origin:right bottom;transform-origin:right bottom}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:before{right:18px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:after{right:20px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right .onesignal-bell-launcher-badge{right:4px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right .onesignal-bell-launcher-message{-webkit-transform-origin:right center;transform-origin:right center}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right .onesignal-bell-launcher-message:after{left:100%;border-left-color:#000}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-bottom-right .onesignal-bell-launcher-button{right:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-button{position:absolute;bottom:0;border-radius:50%;-webkit-transition:border 175ms ease-in-out,width 175ms ease-in-out,height 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:border 175ms ease-in-out,width 175ms ease-in-out,height 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:transform 175ms ease-in-out,border 175ms ease-in-out,width 175ms ease-in-out,height 175ms ease-in-out;transition:transform 175ms ease-in-out,border 175ms ease-in-out,width 175ms ease-in-out,height 175ms ease-in-out,-webkit-transform 175ms ease-in-out;cursor:pointer;z-index:2147483000}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-button svg{width:100%;height:100%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-button.onesignal-bell-launcher-button-hover{cursor:pointer}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-badge{position:absolute;bottom:0;border-radius:50%;text-align:center;top:0;cursor:pointer;-webkit-filter:drop-shadow(0 2px 4px rgba(34,36,38,0));filter:drop-shadow(0 2px 4px rgba(34,36,38,0));-webkit-transition:border 175ms ease-in-out,opacity .21s ease-in-out,width .21s ease-in-out,height .21s ease-in-out,position .21s ease-in-out,right .21s ease-in-out,top .21s ease-in-out,bottom .21s ease-in-out,left .21s ease-in-out,-webkit-transform 175ms ease-in-out;transition:border 175ms ease-in-out,opacity .21s ease-in-out,width .21s ease-in-out,height .21s ease-in-out,position .21s ease-in-out,right .21s ease-in-out,top .21s ease-in-out,bottom .21s ease-in-out,left .21s ease-in-out,-webkit-transform 175ms ease-in-out;transition:transform 175ms ease-in-out,border 175ms ease-in-out,opacity .21s ease-in-out,width .21s ease-in-out,height .21s ease-in-out,position .21s ease-in-out,right .21s ease-in-out,top .21s ease-in-out,bottom .21s ease-in-out,left .21s ease-in-out;transition:transform 175ms ease-in-out,border 175ms ease-in-out,opacity .21s ease-in-out,width .21s ease-in-out,height .21s ease-in-out,position .21s ease-in-out,right .21s ease-in-out,top .21s ease-in-out,bottom .21s ease-in-out,left .21s ease-in-out,-webkit-transform 175ms ease-in-out;z-index:2147483400;opacity:0;-webkit-transform:scale(.01);transform:scale(.01);pointer-events:none}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-badge.onesignal-bell-launcher-badge-hover{cursor:pointer}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-badge.onesignal-bell-launcher-badge-opened{opacity:1;-webkit-transform:scale(1);transform:scale(1)}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-message{position:absolute;color:#fff;background:#000;cursor:pointer;border-radius:5px;-webkit-transform:translateY(-50%) scaleX(0) translateZ(0);transform:translateY(-50%) scaleX(0) translateZ(0);opacity:0;pointer-events:none;-webkit-transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;top:50%;z-index:2147481000}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-message:after{top:50%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none;border-color:transparent}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-message .onesignal-bell-launcher-message-body{z-index:2147482000;max-width:100%;white-space:nowrap;text-overflow:ellipsis}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-message.onesignal-bell-launcher-message-opened{pointer-events:auto;opacity:1;-webkit-transform:translateY(-50%) scaleX(1) translateZ(0);transform:translateY(-50%) scaleX(1) translateZ(0)}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog{cursor:pointer;position:absolute;background-color:#fff;border-radius:5px;border:1px solid rgba(0,0,0,.1);opacity:0;width:200px;-webkit-transform:scale(0) translateZ(0);transform:scale(0) translateZ(0);-webkit-transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out;transition:transform 175ms ease-in-out,opacity 175ms ease-in-out,-webkit-transform 175ms ease-in-out;z-index:2147481000}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog ol{counter-reset:foo;display:table;border-spacing:.3em .75em}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog ol>li{counter-increment:foo;display:table-row;margin-bottom:.75em}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog ol>li:before{content:counter(foo) ".";display:table-cell;text-align:right}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog:after,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog:before{top:100%;border:solid transparent;content:" ";height:0;width:0;position:absolute}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body{z-index:2147482000;max-width:100%;white-space:nowrap;text-overflow:ellipsis;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog.onesignal-bell-launcher-dialog-opened{-webkit-transform:scale(1) translateZ(0);transform:scale(1) translateZ(0);opacity:1}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a{box-sizing:border-box;text-decoration:none;color:initial}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a:active,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a:focus,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a:hover,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a:hover:active,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog a:visited{text-decoration:none;color:initial}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog button{box-sizing:border-box;border:1px solid transparent;padding:.625em 1em;box-shadow:none;border-radius:4px;font-weight:400;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;letter-spacing:.65px;cursor:pointer}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog button.action{color:#fff;background:#e54b4d;width:100%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog button.action:hover{background:#dd2022}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher .onesignal-bell-launcher-dialog button.action:active{background:#b1191b}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm{height:32px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-button{width:32px;height:32px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-badge{font-size:8px;width:12px;height:12px;line-height:12px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-message{padding:9.6px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-message:after{border-width:6.6px;margin-top:-6.6px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-message .onesignal-bell-launcher-message-body{font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog{padding:.3em .8em .6em;color:#333}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:after{border-top-color:#fff;border-width:6.6px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog:before{border-top-color:hsla(0,0%,71%,.1);border-width:8.6px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body{font-size:14px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body h1{font-size:15px;line-height:1.2em;font-weight:500;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;letter-spacing:.2px;text-align:center;color:#41090a}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body p{font-size:14px;font-weight:400;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .divider{border-bottom:1px solid rgba(0,0,0,.1);margin:.25em -.93em}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .kickback{text-align:center;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:300;font-size:9.8px;letter-spacing:.5px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions{max-width:95vw;max-height:70vh;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:400;font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions img{width:100%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification{display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;max-width:330px;border:1px solid rgba(0,0,0,.1);border-radius:3px;background:hsla(0,0%,98%,.5);overflow:auto;margin:.5em 0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon{width:50px;height:50px;margin:6px;margin-right:3px;border-radius:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon.push-notification-icon-default{background:#e3e4e5}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon img{width:50px;height:50px;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container{margin:6px;margin-left:3px;-webkit-flex:1;-webkit-box-flex:1;-ms-flex:1;flex:1}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text{height:5px;width:100%;background:#e3e4e5;margin:5px 0;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-short{width:75%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-medium{width:87%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:first-of-type{margin-top:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-sm .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:last-of-type{margin-bottom:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md{height:48px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-button{width:48px;height:48px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-badge{font-size:12px;width:18px;height:18px;line-height:18px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-message{padding:14.4px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-message:after{border-width:9.9px;margin-top:-9.9px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-message .onesignal-bell-launcher-message-body{font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog{padding:.3em .8em .6em;color:#333}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:after{border-top-color:#fff;border-width:9.9px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog:before{border-top-color:hsla(0,0%,71%,.1);border-width:11.9px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body{font-size:14px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body h1{font-size:15px;line-height:1.2em;font-weight:500;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;letter-spacing:.2px;text-align:center;color:#41090a}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body p{font-size:14px;font-weight:400;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .divider{border-bottom:1px solid rgba(0,0,0,.1);margin:.25em -.93em}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .kickback{text-align:center;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:300;font-size:9.8px;letter-spacing:.5px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions{max-width:95vw;max-height:70vh;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:400;font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions img{width:100%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification{display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;max-width:330px;border:1px solid rgba(0,0,0,.1);border-radius:3px;background:hsla(0,0%,98%,.5);overflow:auto;margin:.5em 0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon{width:50px;height:50px;margin:6px;margin-right:3px;border-radius:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon.push-notification-icon-default{background:#e3e4e5}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon img{width:50px;height:50px;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container{margin:6px;margin-left:3px;-webkit-flex:1;-webkit-box-flex:1;-ms-flex:1;flex:1}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text{height:5px;width:100%;background:#e3e4e5;margin:5px 0;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-short{width:75%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-medium{width:87%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:first-of-type{margin-top:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-md .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:last-of-type{margin-bottom:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg{height:64px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-button{width:64px;height:64px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-badge{font-size:12px;width:24px;height:24px;line-height:24px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-message{padding:19.2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-message:after{border-width:13.2px;margin-top:-13.2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-message .onesignal-bell-launcher-message-body{font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog{padding:.3em .8em .6em;color:#333}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:after{border-top-color:#fff;border-width:13.2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog:before{border-top-color:hsla(0,0%,71%,.1);border-width:15.2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body{font-size:14px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body h1{font-size:15px;line-height:1.2em;font-weight:500;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;letter-spacing:.2px;text-align:center;color:#41090a}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body p{font-size:14px;font-weight:400;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .divider{border-bottom:1px solid rgba(0,0,0,.1);margin:.25em -.93em}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .kickback{text-align:center;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:300;font-size:9.8px;letter-spacing:.5px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions{max-width:95vw;max-height:70vh;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:400;font-size:14px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .instructions img{width:100%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification{display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;max-width:330px;border:1px solid rgba(0,0,0,.1);border-radius:3px;background:hsla(0,0%,98%,.5);overflow:auto;margin:.5em 0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon{width:50px;height:50px;margin:6px;margin-right:3px;border-radius:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon.push-notification-icon-default{background:#e3e4e5}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-icon img{width:50px;height:50px;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container{margin:6px;margin-left:3px;-webkit-flex:1;-webkit-box-flex:1;-ms-flex:1;flex:1}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text{height:5px;width:100%;background:#e3e4e5;margin:5px 0;border-radius:1px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-short{width:75%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text.push-notification-text-medium{width:87%}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:first-of-type{margin-top:2px}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-lg .onesignal-bell-launcher-dialog .onesignal-bell-launcher-dialog-body .push-notification .push-notification-text-container .push-notification-text:last-of-type{margin-bottom:0}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button svg .background{fill:#e54b4d}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button svg .foreground{fill:#fff}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button svg .stroke{fill:none;stroke:#fff;stroke-width:3px;stroke-miterlimit:10}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button.onesignal-bell-launcher-badge-active svg .background,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button.onesignal-bell-launcher-button-active svg .background{fill:#dd2022!important}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-button .pulse-ring{border:7px solid hsla(0,0%,100%,.4)}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-default .onesignal-bell-launcher-badge{border:1px solid #fff;background:#000;color:#fff}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button svg .background{fill:#fff}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button svg .foreground{fill:#e54b4d}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button svg .stroke{fill:none;stroke:#e54b4d;stroke-width:3px;stroke-miterlimit:10}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button.onesignal-bell-launcher-badge-active svg .background,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button.onesignal-bell-launcher-button-active svg .background{fill:#f2f2f2!important}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-button .pulse-ring{border:7px solid rgba(229,75,77,.4)}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher.onesignal-bell-launcher-theme-inverse .onesignal-bell-launcher-badge{border:1px solid #fff;background:#e54b4d;color:#fff}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher-active,#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher-enabled{-webkit-transform:scale(1);transform:scale(1);opacity:1}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher-disabled{visibility:hidden}#onesignal-bell-container.onesignal-reset .onesignal-bell-launcher-inactive{opacity:.5}#onesignal-bell-container.onesignal-reset .pulse-ring{border-radius:50%;position:absolute;left:0;top:0;bottom:0;right:0;-webkit-animation:notifyButtonPulse .35s ease-in-out;animation:notifyButtonPulse .35s ease-in-out;-webkit-animation-iteration-count:1;animation-iteration-count:1;opacity:0;z-index:1000;pointer-events:none}@media print{#onesignal-bell-container{display:none}}@-webkit-keyframes notifyButtonPulse{0%{-webkit-transform:scale(.1);transform:scale(.1);opacity:0;border-width:10px}50%{opacity:1;border-width:5px}to{-webkit-transform:scale(1.2);transform:scale(1.2);opacity:0;border-width:1px}}@keyframes notifyButtonPulse{0%{-webkit-transform:scale(.1);transform:scale(.1);opacity:0;border-width:10px}50%{opacity:1;border-width:5px}to{-webkit-transform:scale(1.2);transform:scale(1.2);opacity:0;border-width:1px}}</style><style type="text/css">#onesignal-popover-container{font-size:14px;position:fixed;z-index:2258594000;left:0;right:0;-webkit-font-smoothing:initial}#onesignal-popover-container.slide-down{top:0}#onesignal-popover-container.slide-down.close-popover #onesignal-popover-dialog{-webkit-animation-name:slideDownExit;-webkit-animation-iteration-count:1;-webkit-animation-timing-function:ease-out;-webkit-animation-duration:.4s;-webkit-animation-fill-mode:forwards;animation-name:slideDownExit;animation-iteration-count:1;animation-timing-function:ease-out;animation-duration:.4s;animation-fill-mode:forwards}#onesignal-popover-container.slide-down #onesignal-popover-dialog{width:500px;-webkit-animation-name:slideDownEnter;-webkit-animation-iteration-count:1;-webkit-animation-timing-function:ease-out;-webkit-animation-duration:.4s;-webkit-animation-fill-mode:forwards;animation-name:slideDownEnter;animation-iteration-count:1;animation-timing-function:ease-out;animation-duration:.4s;animation-fill-mode:forwards}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog{padding:1.714em;width:612px;margin-bottom:18px}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog #blocked-popover{display:block}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog #normal-popover{display:none}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog .popover-body-message{padding:0 .2em;text-align:center;width:100%}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog .popover-body-message img{width:100%}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog .popover-body-message .unblock-image{margin:2em 0 .5em}#onesignal-popover-container.slide-down #onesignal-popover-dialog.blocked-dialog .popover-button.secondary{padding:.714em 2em}#onesignal-popover-container #blocked-popover{display:none}#onesignal-popover-container.slide-up{bottom:0}#onesignal-popover-container.slide-up.close-popover #onesignal-popover-dialog{-webkit-animation-name:slideUpExit;-webkit-animation-iteration-count:1;-webkit-animation-timing-function:ease-out;-webkit-animation-duration:.4s;-webkit-animation-fill-mode:forwards;animation-name:slideUpExit;animation-iteration-count:1;animation-timing-function:ease-out;animation-duration:.4s;animation-fill-mode:forwards}#onesignal-popover-container.slide-up #onesignal-popover-dialog{width:100%;-webkit-animation-name:slideUpEnter;-webkit-animation-iteration-count:1;-webkit-animation-timing-function:ease-out;-webkit-animation-duration:.4s;-webkit-animation-fill-mode:backwards;animation-name:slideUpEnter;animation-iteration-count:1;animation-timing-function:ease-out;animation-duration:.4s;animation-fill-mode:backwards}#onesignal-popover-container #onesignal-popover-dialog{box-sizing:border-box;max-width:100%;margin:0 auto;box-shadow:0 0 20px 3px rgba(0,0,0,.22)!important;background:#fff!important;padding:1.286em;border-bottom-left-radius:2px;border-bottom-right-radius:2px;font-family:Roboto,Noto,Helvetica Neue,Helvetica,Arial,sans-serif}#onesignal-popover-container #onesignal-popover-dialog .popover-body{box-sizing:border-box;margin:0}#onesignal-popover-container #onesignal-popover-dialog .popover-body-icon{box-sizing:border-box;float:left;width:80px;height:80px;background-size:contain;background-position:0 0;background-repeat:no-repeat}#onesignal-popover-container #onesignal-popover-dialog .popover-body-icon.default-icon{background-size:initial;background-position:50% 0}#onesignal-popover-container #onesignal-popover-dialog .popover-body-message{box-sizing:border-box;padding:0 .2em 0 1.286em;float:left;width:calc(100% - 80px);font-size:1.143em;line-height:1.45em;-o-user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;color:#666!important}#onesignal-popover-container #onesignal-popover-dialog button{box-sizing:border-box;display:inline-block;padding:.375rem 1rem;font-size:.9625em;font-weight:400;line-height:1.5;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid transparent;border-radius:.25rem;font-family:inherit;letter-spacing:.05em;-webkit-transition:background-color 75ms ease;transition:background-color 75ms ease;margin:0}#onesignal-popover-container #onesignal-popover-dialog .popover-button{padding:.714em 2em;font-size:1em;text-transform:uppercase;border-radius:2px;font-weight:400}#onesignal-popover-container #onesignal-popover-dialog .popover-button.primary{box-shadow:0 2px 5px 0 rgba(0,0,0,.16),0 2px 6px 0 rgba(0,0,0,.12);background:#4285f4!important;color:#fff!important}#onesignal-popover-container #onesignal-popover-dialog .popover-button.primary:hover{background:#1e6ef2}#onesignal-popover-container #onesignal-popover-dialog .popover-button.primary:active{background:#0d5bdd}#onesignal-popover-container #onesignal-popover-dialog .popover-button.secondary{box-shadow:none;background:#fff!important;color:#4285f4!important}#onesignal-popover-container #onesignal-popover-dialog .popover-button.secondary:hover{color:#0e60e9}#onesignal-popover-container #onesignal-popover-dialog .popover-button.secondary:active{color:#083c92}#onesignal-popover-container #onesignal-popover-dialog .primary.popover-button+.secondary.popover-button{margin-right:.714em}#onesignal-popover-container #onesignal-popover-dialog .popover-footer{position:relative;margin:.25em .25em 0 0}#onesignal-popover-container #onesignal-popover-dialog .align-right{float:right}#onesignal-popover-container #onesignal-popover-dialog .clearfix{display:block}#onesignal-popover-container #onesignal-popover-dialog .clearfix:after{content:'';display:block;height:0;clear:both;visibility:hidden}@-webkit-keyframes slideDownEnter{0%{-webkit-transform:translateY(-150%)}to{-webkit-transform:translateY(0)}}@keyframes slideDownEnter{0%{-webkit-transform:translateY(-150%);transform:translateY(-150%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes slideDownExit{0%{-webkit-transform:translateY(0)}to{-webkit-transform:translateY(-150%)}}@keyframes slideDownExit{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(-150%);transform:translateY(-150%)}}@-webkit-keyframes slideUpEnter{0%{-webkit-transform:translateY(150%)}to{-webkit-transform:translateY(0)}}@keyframes slideUpEnter{0%{-webkit-transform:translateY(150%);transform:translateY(150%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes slideUpExit{0%{-webkit-transform:translateY(0)}to{-webkit-transform:translateY(150%)}}@keyframes slideUpExit{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(150%);transform:translateY(150%)}}</style><script data-rocketsrc="https://tproger.ru/wp-includes/js/wp-emoji-release.min.js?v=18" data-rocketoptimized="true" type="text/javascript"></script></head><body class="single single-post postid-7674 single-format-standard" style="cursor: auto;"><div id="eventfrozen" class="event-frozen"></div><script type="text/rocketscript" data-rocketoptimized="true">var y;y=jQuery(window).scrollTop();if(jQuery(window).width()>979){var didScroll=false;jQuery(window).scroll(function(){didScroll=true;});setInterval(function(){if(didScroll){didScroll=false;y=jQuery(window).scrollTop();if(y>jQuery('#masthead .top-duft-punk').height()){jQuery('#masthead .bluth-navigation').addClass('fixed');}else{jQuery('#masthead .bluth-navigation').removeClass('fixed');jQuery('#main').css('padding-top','');}
if(y>(jQuery('#masthead .top-duft-punk').height()+100)){jQuery('#masthead .bluth-navigation').addClass('shrunk');}else{jQuery('#masthead .bluth-navigation').removeClass('shrunk');}
changeHeader();}},50);}
jQuery(function(){if(jQuery(window).width()>979)
changeHeader();else{jQuery('#masthead .bluth-navigation .navbar .nav > li > a, #masthead .searchform a').animate({color:'#333333'},10);jQuery('#masthead .bluth-navigation').animate({backgroundColor:'#ffffff'},100);}
var didresize=false;jQuery(window).resize(function(){});setInterval(function(){if(didresize){didresize=false;}},3000);jQuery('.navbar .nav li').mouseover(function(){jQuery(this).addClass('open');});jQuery('.navbar .nav li').mouseout(function(){jQuery(this).removeClass('open');});resetNavLine(250);jQuery('#masthead .nav li').mouseover(function(){jQuery('.nav-line').stop();jQuery('.nav-line').animate({left:jQuery(this).offset().left-jQuery('.bluth-navigation .container .navbar').offset().left,width:jQuery(this).width()},250);});jQuery('#masthead .nav li').mouseout(function(){resetNavLine(250);});});function changeHeader(){var y;y=jQuery(window).scrollTop();jQuery('#masthead .bluth-navigation').stop();}
function resetNavLine(time){jQuery('.nav-line').stop();if(jQuery('.nav').children('li').hasClass('current-menu-item')){jQuery('.nav-line').animate({left:jQuery('.current-menu-item').offset().left-jQuery('.bluth-navigation .container .navbar').offset().left,width:jQuery('.current-menu-item').width()},time);}else if(jQuery('.nav').children('li').hasClass('current-menu-ancestor')){jQuery('.nav-line').animate({left:jQuery('.current-menu-ancestor').offset().left-jQuery('.bluth-navigation .container .navbar').offset().left,width:jQuery('.current-menu-ancestor').width()},time);}else{jQuery('.nav-line').animate({width:0});}}</script><div id="page" class="site"> <header id="masthead" role="banner" class="header_normal"><div class="image-overflow"><div class="header-background-image"></div></div><div class="row-fluid top-duft-punk" style="height:auto;"><div class="container"><div class="banner-overlay"></div><h1 class="text_logo bounceable"> <a href="https://tproger.ru/"> <img src="./Трассировщик лучей на визитке _ Типичный программист_files/tp-circle.png" id="logo" alt=""> <span class="brand_name"> Tproger </span> </a></h1><div class="tmenu" id="tmenu"><div class="tmenu_container"><ul id="menu-%d0%93%d0%bb%d0%b0%d0%b2%d0%bd%d0%be%d0%b5" class="tmenu_column"><li id="menu-item-21202" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Новости" href="https://tproger.ru/category/news/">Новости</a></li><li id="menu-item-12274" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Задачи с IT-собеседований" href="https://tproger.ru/category/problems/">Задачи с IT-собеседований</a></li><li id="menu-item-21201" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Ответы экспертов" href="https://tproger.ru/category/experts/">Эксперты отвечают читателям</a></li><li id="menu-item-21200" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Викторины" href="https://tproger.ru/category/quiz/">Викторины</a></li><li id="menu-item-12276" class="menu-item menu-item-type-post_type menu-item-object-page tag-menu-item"><a href="https://tproger.ru/about/">О проекте</a></li><li id="menu-item-12805" class="menu-item menu-item-type-post_type menu-item-object-page tag-menu-item"><a title="Реклама" href="https://tproger.ru/ad/">Реклама</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Свежие статьи" href="https://tproger.ru/">Свежие статьи</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за неделю" href="https://tproger.ru/top/week">Лучшие за неделю</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за месяц" href="https://tproger.ru/top/month">Лучшие за месяц</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за всё время" href="https://tproger.ru/top/evers">Лучшие за всё время</a></li></ul></div></div><div class="brandmenu_container"> <a class="brand-item" href="https://tproger.ru/search/" id="search_icon"><img class="tmenu_icon" src="./Трассировщик лучей на визитке _ Типичный программист_files/icon_search.svg" alt="Search"></a> <a class="brand-item" id="expand_icon"><img class="tmenu_icon" src="./Трассировщик лучей на визитке _ Типичный программист_files/icon_menu.svg" alt="Search"></a></div><div class="top-duft-punk-social pull-right" style="top:15px;"></div></div><div class="tmenu" id="tmenu_collapse"><div class="tmenu_container"><ul id="menu-%d0%93%d0%bb%d0%b0%d0%b2%d0%bd%d0%be%d0%b5" class="tmenu_column"><li id="menu-item-21202" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Новости" href="https://tproger.ru/category/news/">Новости</a></li><li id="menu-item-12274" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Задачи с IT-собеседований" href="https://tproger.ru/category/problems/">Задачи с IT-собеседований</a></li><li id="menu-item-21201" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Ответы экспертов" href="https://tproger.ru/category/experts/">Эксперты отвечают читателям</a></li><li id="menu-item-21200" class="menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"><a title="Викторины" href="https://tproger.ru/category/quiz/">Викторины</a></li><li id="menu-item-12276" class="menu-item menu-item-type-post_type menu-item-object-page tag-menu-item"><a href="https://tproger.ru/about/">О проекте</a></li><li id="menu-item-12805" class="menu-item menu-item-type-post_type menu-item-object-page tag-menu-item"><a title="Реклама" href="https://tproger.ru/ad/">Реклама</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Свежие статьи" href="https://tproger.ru/">Свежие статьи</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за неделю" href="https://tproger.ru/top/week">Лучшие за неделю</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за месяц" href="https://tproger.ru/top/month">Лучшие за месяц</a></li><li id="menu-item" class="visible-phone menu-item menu-item-type-taxonomy menu-item-object-category tag-menu-item"> <a title="Лучшие за всё время" href="https://tproger.ru/top/evers">Лучшие за всё время</a></li></ul></div></div></div><div class="header_searchbox" id="searchbox"><form method="get" action="https://tproger.ru/search"><div class="header_searchbox_input_wrapper"> <input name="q" maxlength="128" class="header_searchbox_input" placeholder="Введите запрос и нажмите Enter..."> <span class="header_searchbox_input_cancel dashicons dashicons-no-alt"></span></div></form></div><div class="row-fluid bluth-navigation fixed shrunk"><div class="container"><div class="mini-logo"> <a class="mini mini-image" href="https://tproger.ru/" title="Типичный программист" rel="home"><img width="25" height="25" src="./Трассировщик лучей на визитке _ Типичный программист_files/logo25.png" alt="Типичный программист"></a></div><div class="navbar navbar-inverse"><div class="navbar-inner"><div class="nav-collapse collapse"><ul id="menu-%d0%a2%d0%b5%d0%bc%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b5-%d1%82%d0%b5%d0%b3%d0%b8" class="nav visible-desktop"><li id="menu-item-12278" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Алгоритмы" href="https://tproger.ru/tag/algorithms/">Алгоритмы</a></li><li id="menu-item-12285" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Для новичков" href="https://tproger.ru/tag/for-beginners/">Для новичков</a></li><li id="menu-item-12280" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Gamedev" href="https://tproger.ru/tag/gamedev/">Gamedev</a></li><li id="menu-item-12281" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Mobile" href="https://tproger.ru/tag/mobiledev/">Mobile</a></li><li id="menu-item-12283" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Web" href="https://tproger.ru/tag/web/">Web</a></li><li id="menu-item-12284" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Linux" href="https://tproger.ru/tag/linux/">Linux</a></li><li id="menu-item-12279" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Android" href="https://tproger.ru/tag/android/">Android</a></li><li id="menu-item-12282" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="С++" href="https://tproger.ru/tag/cpp/">С++</a></li><li id="menu-item-18992" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Язык Си" href="https://tproger.ru/tag/c-language/">Язык Си</a></li><li id="menu-item-12286" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="C#" href="https://tproger.ru/tag/c-sharp/">C#</a></li><li id="menu-item-12287" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Java" href="https://tproger.ru/tag/java/">Java</a></li><li id="menu-item-20934" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="JavaScript" href="https://tproger.ru/tag/javascript/">JS</a></li><li id="menu-item-20935" class="menu-item menu-item-type-custom menu-item-object-custom tag-menu-item"><a title="Python" href="https://tproger.ru/tag/python/">Python</a></li></ul><div class="feed_switcher_wrapper"><div id="loading_switcher" class="loading-vertical" style="display: none;"><i></i><i></i><i></i></div><div class="switcher_content" style="display: block;"> <span class="second"> <i class="icon_hot sprite sprite-hot" alt=""></i> Показать лучшие за <select id="feed_mode_select"><option class="mode_select_option&quot;" value="week">неделю</option><option value="month">1 месяц</option><option value="ever">100 лет</option> </select> </span> <span class="tumbler"></span> <span class="first">Свежие</span></div></div></div></div><div class="nav-line" style="width: 0px; left: 133.302px;"></div></div></div></div></header><div id="main" class="container"><div id="primary" class="row right_side"><div id="content" class="span8" role="main"> <article id="post-7674" class="post-7674 post type-post status-publish format-standard has-post-thumbnail hentry category-translations tag-cpp tag-good-hack"><div class="post-title box"><h1 class="entry-title">Трассировщик лучей на визитке</h1><div class="post-meta"><ul><li><time class="entry-date updated" datetime="2015-08-26T15:27:43+00:00">26 августа 2015 в 15:27</time>, <a href="https://tproger.ru/category/translations/" title="Все посты категории Переводы">Переводы</a></li><li><div class="time_read" title="Примерное время, необходимое для чтения статьи"> <i class="sprite sprite-hourglass" style="margin-top:-2px;opacity:0.5;"></i> <span class="time_read_minutes">17 минут</span></div></li><li data-role="post_views"><div class="post-views post-7674 entry-meta">
				<span class="post-views-icon dashicons  dashicons-visibility"></span>
				
				<span class="post-views-count">3&nbsp;793</span>
			</div></li><script type="text/rocketscript" data-rocketoptimized="true">/*<![CDATA[*/var getPostViews=function(element){var xhr=new XMLHttpRequest();xhr.open('GET','/wp-admin/admin-ajax.php?action=getPostViewsNoCache&get_pvc_by_post_id=7674');xhr.send();xhr.onreadystatechange=function(){var DONE=4;var OK=200;if(xhr.readyState===DONE){if(xhr.status===OK){element.innerHTML=xhr.responseText;}else{console.log('Error: '+xhr.status);}}};};getPostViews(document.querySelector('[data-role="post_views"]'));/*]]>*/</script></ul><div class="vk_like" id="vk_like_7674" style="height: 20px; width: 180px; position: relative; clear: both; background: none;"><iframe name="fXD3186b" frameborder="0" src="./Трассировщик лучей на визитке _ Типичный программист_files/widget_like.html" width="100%" height="20" scrolling="no" id="vkwidget1" style="overflow: hidden; height: 20px; width: 180px; z-index: 150;"></iframe></div><script type="text/rocketscript" data-rocketoptimized="true">VK.Widgets.Like("vk_like_7674",{type:"button",verb:1,height:20},7674);</script></div><div class="post-format-badge post-format-standard"></div></div><div class="entry-image" style=""> <a href="./Трассировщик лучей на визитке _ Типичный программист_files/Untitled7.png" class="lightbox" title="Трассировщик лучей на визитке" rel="bookmark"> <img width="770" height="270" src="./Трассировщик лучей на визитке _ Типичный программист_files/Untitled7.png" class="attachment-gallery-large size-gallery-large wp-post-image" alt="Untitled" srcset="https://tproger2.azureedge.net/wp-content/uploads/2015/07/Untitled7.png 770w, https://tproger2.azureedge.net/wp-content/uploads/2015/07/Untitled7-300x105.png 300w" sizes="(max-width: 770px) 100vw, 770px"> </a></div><div class="entry-container "><div class="entry-content"><p style="text-align: right;"><em>Рассказывает Фабиен Санглард, автор блога <a href="http://fabiensanglard.net/" target="_blank" rel="noopener noreferrer">fabiensanglard.net</a></em></p><hr><p>Недавно в интернете я наткнулся на трассировщик лучей на визитке Пола Гекберта. Для тех, кто не в курсе: это очень известная задача, изначально предложенная Полом Гекбертом 4-ого мая 1984 на comp.graphics. Ее суть в том, чтобы написать демонстрацию метода бросания лучей, которая бы… умещалась на визитной карточке (больше об этом читайте в разделе <a href="https://books.google.ca/books?id=CCqzMm_-WucC&amp;lpg=PA351&amp;hl=ru&amp;pg=PA351#v=onepage&amp;q&amp;f=false" target="_blank" rel="noopener noreferrer">«Трассировка лучей»</a> из книги <a href="http://www.amazon.ca/Graphics-Gems-IV-IBM-Version/dp/0123361559/ref=sr_1_1?ie=UTF8&amp;qid=1379718285&amp;sr=8-1&amp;keywords=Graphics+Gems+IV" target="_blank" rel="noopener noreferrer">«Графические драгоценности IV»</a>)!</p><p>Версия Эндрю Кенслера — одна из самых потрясающих и красивых реализаций этой задачи, которые я видел. Из любопытства я решил разобраться в ней. В этой статье я напишу все, что смог понять сам.<span id="more-7674"></span></p><h3>Обратная сторона визитки</h3><p>Вот так выглядит сам код:</p><div id="crayon-57dd567c56c83791117308" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-12">12</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-14">14</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-16">16</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-18">18</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-20">20</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-22">22</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-24">24</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-26">26</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-28">28</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-30">30</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-32">32</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c83791117308-34">34</div><div class="crayon-num" data-line="crayon-57dd567c56c83791117308-35">35</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56c83791117308-1"><span class="crayon-h"> </span><span class="crayon-p">#include &lt;stdlib.h&gt;&nbsp;&nbsp; // card &gt; aek.ppm</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#include &lt;stdio.h&gt;</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#include &lt;math.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">;</span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-i">r</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">-</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-sy">;</span><span class="crayon-v">z</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">v</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">operator</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">%</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-cn">247570</span><span class="crayon-sy">,</span><span class="crayon-cn">280596</span><span class="crayon-sy">,</span><span class="crayon-cn">280600</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">249748</span><span class="crayon-sy">,</span><span class="crayon-cn">18578</span><span class="crayon-sy">,</span><span class="crayon-cn">18577</span><span class="crayon-sy">,</span><span class="crayon-cn">231184</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">RAND_MAX</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">f</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">&amp;t</span><span class="crayon-sy">,</span><span class="crayon-v">v</span><span class="crayon-v">&amp;n</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-cn">1e9</span><span class="crayon-sy">;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">o</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">/</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">;</span><span class="crayon-v">k</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">;</span><span class="crayon-v">j</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-o">&lt;&lt;</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-i">k</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-v">j</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">p</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-o">&lt;</span><span class="crayon-v">t</span><span class="crayon-o">&amp;&amp;</span><span class="crayon-v">s</span><span class="crayon-o">&gt;</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span><span class="crayon-sy">)</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-i">t</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">m</span><span class="crayon-sy">)</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">l</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-o">&lt;</span><span class="crayon-cn">0</span><span class="crayon-o">||</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">l</span><span class="crayon-o">%</span><span class="crayon-v">r</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">99</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">?</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-o">+</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"P6 512 512 255 "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-e">v</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-v">g</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">g</span><span class="crayon-o">^</span><span class="crayon-i">a</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">+</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">256</span><span class="crayon-o">+</span><span class="crayon-v">g</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">x</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">r</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">;</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">99</span><span class="crayon-o">+</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">99</span><span class="crayon-sy">;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">b</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c83791117308-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">3.5</span><span class="crayon-o">+</span><span class="crayon-v">p</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"%c%c%c"</span></div><div class="crayon-line" id="crayon-57dd567c56c83791117308-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p> Код выше выглядит… пугающе, но компилируется и запускается без проблем! Вы можете сохранить его на рабочем столе как <code>card.cpp</code>, открыть консоль и ввести:</p><div id="crayon-57dd567c56c90122130753" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56c90122130753-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c90122130753-2">2</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56c90122130753-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-o">++</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">O3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-e">card </span><span class="crayon-v">card</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c90122130753-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-v">card</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">card</span><span class="crayon-sy">.</span><span class="crayon-v">ppm</span></div></div></td></tr></tbody></table></div></div><p> Через 27 секунд на экране появится следующее изображение:</p><p><img src="http://fabiensanglard.net/rayTracing_back_of_business_card/minray.png" alt=""></p><h3>Возможности визитки-трассировщика лучей</h3><p>Возможности просто поражают!</p><ul><li>мир, состоящий из строго организованных сфер;</li><li>текстурированный пол;</li><li>небо с градиентом;</li><li>мягкие тени;</li><li>OMG, глубина резкости! Вы шутите?!</li></ul><p>И все это на одной стороне визитной карточки! Посмотрим, как это работает.</p><h3>Класс Vector</h3><p>Рассмотрим первую часть кода:</p><div id="crayon-57dd567c56c95439541064" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56c95439541064-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c95439541064-12">12</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56c95439541064-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#include &lt;stdlib.h&gt;&nbsp;&nbsp; // card &gt; aek.ppm</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#include &lt;stdio.h&gt;</span></div><div class="crayon-line" id="crayon-57dd567c56c95439541064-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#include &lt;math.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">;</span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57dd567c56c95439541064-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-57dd567c56c95439541064-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-i">r</span></div><div class="crayon-line" id="crayon-57dd567c56c95439541064-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">-</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-sy">;</span><span class="crayon-v">z</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-i">v</span></div><div class="crayon-line" id="crayon-57dd567c56c95439541064-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">operator</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">%</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c95439541064-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td></tr></tbody></table></div></div><p> Главная хитрость здесь — это сокращение ключевых слов типов <code>int</code> и <code>float</code> до <code>i</code> и <code>f</code> с помощью <code>typedef</code>. Другой ход, с помощью которого можно можно уменьшить количество кода — это класс <code>v</code>, используемый не только в качестве вектора, но и для обработки пикселей.</p><p>Вот код, приведенный выше, но отформатированный и с комментариями:</p><div id="crayon-57dd567c56c9c407307870" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-12">12</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-14">14</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-16">16</div><div class="crayon-num" data-line="crayon-57dd567c56c9c407307870-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56c9c407307870-18">18</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56c9c407307870-1"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-p">#include &lt;stdlib.h&gt;&nbsp;&nbsp; // card &gt; aek.ppm</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-2"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-p">#include &lt;stdio.h&gt;</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-p">#include &lt;math.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-4">&nbsp;</div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-5"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Экономим место с помощью сокращения int до i</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-6"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Экономим еще больше места с f вместо float</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-8"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Класс вектора с конструктором и операторами</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-9"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Три координаты вектора</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">+</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// Сумма векторов</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Масштабирование векторов</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">+</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Скалярное произведение векторов</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Пустой конструктор</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">-</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-v">z</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-v">y</span><span class="crayon-o">*</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// Векторное произведение векторов</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-sy">;</span><span class="crayon-v">z</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Конструктор</span></div><div class="crayon-line" id="crayon-57dd567c56c9c407307870-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-t">operator</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-o">%</span><span class="crayon-o">*</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// Нормализация вектора</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56c9c407307870-18"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td></tr></tbody></table></div></div><p></p><h3>Rand()&nbsp;и данные для генерации мира</h3><p></p><div id="crayon-57dd567c56ca0192679002" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56ca0192679002-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca0192679002-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56ca0192679002-3">3</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56ca0192679002-1"><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-cn">247570</span><span class="crayon-sy">,</span><span class="crayon-cn">280596</span><span class="crayon-sy">,</span><span class="crayon-cn">280600</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca0192679002-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">249748</span><span class="crayon-sy">,</span><span class="crayon-cn">18578</span><span class="crayon-sy">,</span><span class="crayon-cn">18577</span><span class="crayon-sy">,</span><span class="crayon-cn">231184</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57dd567c56ca0192679002-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">RAND_MAX</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p> Следующий код также экономит много места с помощью объявления функции <code>R</code>, которая возвращает случайное значение от 0 до 1 типа float. Это полезно при стохастическом сэмплировании, использующемся для blur-эффекта и мягких теней.</p><p>Массив <code>G</code> содержит в себе закодированное целыми числами положение сфер в мире. Совокупность всех чисел — это битовый вектор из 9 строк и 19 столбцов.</p><p>Вот код, приведенный выше, но отформатированный и с комментариями:</p><div id="crayon-57dd567c56ca3168911766" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56ca3168911766-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca3168911766-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56ca3168911766-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca3168911766-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56ca3168911766-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca3168911766-6">6</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56ca3168911766-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Набор позиций сфер, описывающий мир</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca3168911766-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Все эти числа, по сути, являются по сути битовым вектором</span></div><div class="crayon-line" id="crayon-57dd567c56ca3168911766-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-cn">247570</span><span class="crayon-sy">,</span><span class="crayon-cn">280596</span><span class="crayon-sy">,</span><span class="crayon-cn">280600</span><span class="crayon-sy">,</span><span class="crayon-cn">249748</span><span class="crayon-sy">,</span><span class="crayon-cn">18578</span><span class="crayon-sy">,</span><span class="crayon-cn">18577</span><span class="crayon-sy">,</span><span class="crayon-cn">231184</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca3168911766-4"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56ca3168911766-5"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Генератор случайных чисел, возвращающий число с плавающей точкой в диапазоне 0-1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca3168911766-6"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">RAND_MAX</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><h3>Главный метод</h3><p></p><div id="crayon-57dd567c56ca6335176993" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56ca6335176993-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca6335176993-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56ca6335176993-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca6335176993-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56ca6335176993-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca6335176993-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56ca6335176993-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ca6335176993-8">8</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56ca6335176993-1"><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"P6 512 512 255 "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-e">v</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca6335176993-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-v">g</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">g</span><span class="crayon-o">^</span><span class="crayon-i">a</span></div><div class="crayon-line" id="crayon-57dd567c56ca6335176993-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">+</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">256</span><span class="crayon-o">+</span><span class="crayon-v">g</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca6335176993-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">x</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">r</span></div><div class="crayon-line" id="crayon-57dd567c56ca6335176993-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">;</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">99</span><span class="crayon-o">+</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca6335176993-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">99</span><span class="crayon-sy">;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">b</span></div><div class="crayon-line" id="crayon-57dd567c56ca6335176993-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">3.5</span><span class="crayon-o">+</span><span class="crayon-v">p</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"%c%c%c"</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ca6335176993-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p> Главный метод использует простой известный основанный на тексте формат изображений PPM. Изображение состоит из заголовка вида <code>P6 [Ширина] [Высота] [Максимальное значение]</code>, за которым следует RGB-значение каждого пикселя.</p><p>Для каждого пикселя на изображении программа сэмплирует (S) цвет 64 лучей, аккумулирует результат и выводит его в <code>stdout</code>.</p><p>Также этот код немного изменяет каждую координату начала луча и его направление. Это делается затем, чтобы создать эффект глубины резкости.</p><p>Вот код, приведенный выше, но отформатированный и с комментариями:</p><div id="crayon-57dd567c56caa287913627" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-12">12</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-14">14</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-16">16</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-18">18</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-20">20</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-22">22</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-24">24</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-26">26</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-28">28</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-30">30</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-32">32</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-34">34</div><div class="crayon-num" data-line="crayon-57dd567c56caa287913627-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caa287913627-36">36</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56caa287913627-1"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Главная функция. Выводит изображение.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Использовать программу просто: ./card &gt; erk.ppm</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"P6 512 512 255 "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Заголовок PPM</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Оператор "!" осуществляет нормализацию вектора</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Направление камеры</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-v">g</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// Вектор, отвечающий за высоту камеры...</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">g</span><span class="crayon-o">^</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">002</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Правый вектор, получаемый с помощью векторного произведения</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">+</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">256</span><span class="crayon-o">+</span><span class="crayon-v">g</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// WTF? Вот здесь https:// news.ycombinator.com/item?id=6425965 написано про это подробнее.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-12">&nbsp;</div><div class="crayon-line" id="crayon-57dd567c56caa287913627-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">y</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Для каждого столбца</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-cn">512</span><span class="crayon-sy">;</span><span class="crayon-v">x</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Для каждого пикселя в строке</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Используем класс вектора, чтобы хранить цвет в RGB</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Стандартный цвет пикселя — почти черный</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Бросаем по 64 луча из каждого пикселя </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">;</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Немного меняем влево/вправо и вверх/вниз координаты начала луча (для эффекта глубины резкости)</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-e ">a*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">99</span><span class="crayon-o">+</span><span class="crayon-e ">b*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">99</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Назначаем фокальной точкой камеры v(17,16,8) и бросаем луч </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Аккумулируем цвет, возвращенный в переменной t</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// Начало луча</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e ">t*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">a*</span><span class="crayon-sy">(</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e ">b*</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">// Направление луча с небольшим искажением</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// ради эффекта стохастического сэмплирования</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">3.5</span><span class="crayon-o">+</span><span class="crayon-v">p</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// +p для аккумуляции цвета</span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"%c%c%c"</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56caa287913627-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caa287913627-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><h3>Сэмплер</h3><p></p><div id="crayon-57dd567c56caf020293894" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56caf020293894-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caf020293894-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56caf020293894-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caf020293894-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56caf020293894-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caf020293894-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56caf020293894-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56caf020293894-8">8</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56caf020293894-1"><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-i">t</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caf020293894-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">m</span><span class="crayon-sy">)</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57dd567c56caf020293894-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">l</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caf020293894-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-57dd567c56caf020293894-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-o">&lt;</span><span class="crayon-cn">0</span><span class="crayon-o">||</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">l</span><span class="crayon-o">%</span><span class="crayon-v">r</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caf020293894-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">99</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57dd567c56caf020293894-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">?</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56caf020293894-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-o">+</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p> Сэмплер (<code>S</code>) — это функция, возвращающая цвет пикселя по данным координатам точки начала луча (<code>о</code>) и его направлению (<code>d</code>). Если она натыкается на сферу, то она вызывает себя рекурсивно, а в ином случае (если луч не имеет препятствий на своем пути) в зависимости от направления возвращает либо цвет неба, либо цвет пола (базируясь на его клетчатой текстуре).</p><p>Обратите внимание на вызов функции <code>R</code> при расчете направления света. Таким образом создается эффект «мягких теней».</p><p>Вот код, приведенный выше, но отформатированный и с комментариями:</p><div id="crayon-57dd567c56cbc567606231" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-12">12</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-14">14</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-16">16</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-18">18</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-20">20</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-22">22</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-24">24</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-26">26</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-28">28</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-30">30</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-32">32</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-34">34</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-36">36</div><div class="crayon-num" data-line="crayon-57dd567c56cbc567606231-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cbc567606231-38">38</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56cbc567606231-1"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// (S)эмплируем мир и возвращаем цвет пикселя по</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-2"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// по лучу, начинающемуся в точке o (Origin) и имеющему направление d (Direction)</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Проверяем, натыкается ли луч на что-нибудь</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">m</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">// m==0</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Сфера не была найдена, и луч идет вверх: генерируем цвет неба&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-sy">.</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-14">&nbsp;</div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Возможно, луч задевает сферу</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// h - координата пересечения</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">l</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-e">R</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// 'l' = направление света (с небольшим искажеем для эффекта мягких теней)</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// r = полувектор</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-20"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Расчитываем коэффицент Ламберта</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-o">%</span><span class="crayon-v">n</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Рассчитываем фактор освещения (коэффицент Ламберта &gt; 0 или находимся в тени)?</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-o">&lt;</span><span class="crayon-cn">0</span><span class="crayon-o">||</span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-27"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Рассчитываем цвет p (с учетом диффузии и отражения света) </span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">l</span><span class="crayon-o">%</span><span class="crayon-v">r</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">99</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// m == 1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-v">h</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Сфера не была задета, и луч уходит вниз, в пол: генерируем цвет пола</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-sy">?</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-o">+</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-35"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// m == 2 Была задета сфера: генерируем луч, отскакивающий от поверхности сфера</span></div><div class="crayon-line" id="crayon-57dd567c56cbc567606231-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">S</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-cn">5</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Ослабляем цвет на 50%, так как он отскакивает от поверхности (* .5)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cbc567606231-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><h3>Трэйсер</h3><p></p><div id="crayon-57dd567c56cc1985727094" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56cc1985727094-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc1985727094-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56cc1985727094-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc1985727094-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56cc1985727094-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc1985727094-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56cc1985727094-7">7</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56cc1985727094-1"><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">f</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc1985727094-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">&amp;t</span><span class="crayon-sy">,</span><span class="crayon-v">v</span><span class="crayon-v">&amp;n</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-cn">1e9</span><span class="crayon-sy">;</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">o</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">/</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span></div><div class="crayon-line" id="crayon-57dd567c56cc1985727094-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">;</span><span class="crayon-v">k</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc1985727094-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">;</span><span class="crayon-v">j</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-o">&lt;&lt;</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-57dd567c56cc1985727094-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-v">j</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">p</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc1985727094-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-o">&lt;</span><span class="crayon-v">t</span><span class="crayon-o">&amp;&amp;</span><span class="crayon-v">s</span><span class="crayon-o">&gt;</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span><span class="crayon-sy">)</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57dd567c56cc1985727094-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p> Функция <code>T</code> (Tracer) отвечает за бросание луча из данной точки (<code>o</code>) в данном направлении (<code>d</code>). Она возвращает целое число, которое является кодом для результата бросания луча. <code>0</code> — луч ушел в небо, <code>1</code> — луч ушел в пол, <code>2</code> — луч наткнулся на сферу. Если была задета сфера, то функция обновляет переменные <code>t</code> (параметр, используемый для вычисления дистанции пересения) и <code>n</code> (полу-вектор при отскакивании от сферы).<code></code></p><p>Вот код, приведенный выше, но отформатированный и с комментариями:</p><div id="crayon-57dd567c56cc5360869988" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-4">4</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-6">6</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-8">8</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-10">10</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-12">12</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-14">14</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-16">16</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-18">18</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-20">20</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-22">22</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-24">24</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-26">26</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-28">28</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-30">30</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-32">32</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-34">34</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-36">36</div><div class="crayon-num" data-line="crayon-57dd567c56cc5360869988-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56cc5360869988-38">38</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56cc5360869988-1"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Тест на пересечение для линии [o,v]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-2"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Возвращаем 2, если была задета сфера (а также дистанцию пересечения t и полу-вектор n).</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Возвращаем 0, если луч ничего не задевает и идет вверх, в небо</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-4"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Возвращаем 1, если луч ничего не задевает и идет вниз, в пол</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-5"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">T</span><span class="crayon-sy">(</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">f</span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-v">v</span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-cn">1e9</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">o</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-o">/</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-sy">)</span>›</div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Мир зашифрован в G, в 9 линий и 19 столбцов</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">;</span><span class="crayon-v">k</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Для каждого столбца</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">;</span><span class="crayon-v">j</span><span class="crayon-o">--</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Для каждой строки</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">G</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-o">&lt;&lt;</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// Для этой линии j есть ли в столбце i cфера?</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Сфера есть, но задевает ли ее луч?</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-v">o</span><span class="crayon-o">+</span><span class="crayon-e">v</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-v">j</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-o">%</span><span class="crayon-v">p</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-o">*</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-v">c</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Задевает ли луч сферу?</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Да. Считаем расстояние от камеры до сферы</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-v">b</span><span class="crayon-o">-</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-o">&lt;</span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">&gt;</span><span class="crayon-sy">.</span><span class="crayon-cn">01</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Это минимальное расстояние, сохраняем его. А также</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// вычиваем вектор отскакивающего луча и записываем его в 'n'&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-o">+</span><span class="crayon-v">d</span><span class="crayon-o">*</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-57dd567c56cc5360869988-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56cc5360869988-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><h3>Число Leet</h3><p></p><p>Многие программисты пытались сократить код еще больше. Сам автор остановился на версии, предоставленной в этой статье. Знаете, почему?</p><div id="crayon-57dd567c56ccb150672227" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div class="crayon-plain-wrap"></div><div class="crayon-main" style=""><table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="show"><div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57dd567c56ccb150672227-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57dd567c56ccb150672227-2">2</div><div class="crayon-num" data-line="crayon-57dd567c56ccb150672227-3">3</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57dd567c56ccb150672227-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fabien</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">wc </span><span class="crayon-v">card</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span></div><div class="crayon-line crayon-striped-line" id="crayon-57dd567c56ccb150672227-2">&nbsp;</div><div class="crayon-line" id="crayon-57dd567c56ccb150672227-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">35</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">95</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">1337</span><span class="crayon-h"> </span><span class="crayon-v">card</span><span class="crayon-sy">.</span><span class="crayon-v">cpp</span></div></div></td></tr></tbody></table></div></div><p> Его размер — 1337 байт! <a href="https://ru.wikipedia.org/wiki/Leet" target="_blank" rel="noopener noreferrer">Число Leet!</a> Ха!</p><h3>Материалы для ознакомления</h3><p>Так как я провел очень много времени, читая про сам метод бросания лучей, вот несколько интересных ссылок и книг:</p><ul><li><a href="http://www.scratchapixel.com/" target="_blank" rel="noopener noreferrer">scratchpixel.com</a> — уроки по методу бросания лучей от профессионалов, работавших над «Историей игрушек», «Властелином колец», «Аватаром», «Гарри Поттером», «Пиратами Карибского моря» и многими другими фильмами;</li><li><a href="http://www.amazon.com/Introduction-Tracing-Kaufmann-Computer-Graphics/dp/0122861604/ref=sr_1_1?ie=UTF8&amp;qid=1379818206&amp;sr=8-1&amp;keywords=introduction+to+raytracing" target="_blank" rel="noopener noreferrer">«Введение в метод бросания лучей»</a> — довольно старая, но классическая книга;</li><li><a href="http://www.amazon.com/Physically-Based-Rendering-Second-Edition/dp/0123750792/ref=sr_1_fkmr0_1?ie=UTF8&amp;qid=1379818262&amp;sr=8-1-fkmr0&amp;keywords=physically+based+raytracer" target="_blank" rel="noopener noreferrer">«Рендеринг, основанный на физике»</a> — много математики, но все очень подробно и ясно объясняется.</li></ul><p style="text-align: right;"><sub>Перевод статьи <a href="http://fabiensanglard.net/rayTracing_back_of_business_card/" target="_blank" rel="noopener noreferrer">«Decyphering the business card racetracer»</a></sub></p><div class="mistape_caption"></div> <footer class="entry-meta clearfix"><ul><li><a href="https://tproger.ru/tag/cpp/" rel="tag">C++</a>, <a href="https://tproger.ru/tag/good-hack/" rel="tag">Красивый хак</a></li></ul><div class="vk_like" id="vk_like_bottom_7674" style="height: 20px; width: 180px; position: relative; clear: both; background: none;"><iframe name="fXD86abf" frameborder="0" src="./Трассировщик лучей на визитке _ Типичный программист_files/widget_like(1).html" width="100%" height="20" scrolling="no" id="vkwidget2" style="overflow: hidden; height: 20px; width: 180px; z-index: 150;"></iframe></div><script type="text/rocketscript" data-rocketoptimized="true">VK.Widgets.Like("vk_like_bottom_7674",{type:"button",verb:1,height:20},7674);</script></footer></div></div> <span class="vcard" style="display: none;"> <span class="fn"> <a href="https://tproger.ru/author/tproger/" class="author">Типичный программист</a> </span> </span> </article><div style="margin-top: 30px;" class="above_content"> <article style="text-align: center;" class=""> <ins id="google-ads-1" class="adsbygoogle" data-betweenposts="false" data-ad-client="ca-pub-9189593931769509" data-ad-slot="3021004276" data-ad-format="auto" style="display:inline-block;width:728px;height:90px" data-adsbygoogle-status="done"></ins> </article></div><div id="related-posts" class="row-fluid box"><h4 style="text-align:center;margin-top: 5px;margin-bottom: 15px;">Другим программистам нравится:</h4><div> <a href="https://tproger.ru/digest/top-cheatsheets/" class="srvn_article clearfix"><div class="srvn_article_image" style="background-image: url(https://tproger2.azureedge.net/wp-content/uploads/2016/09/1966aec70bb327be3810af86a7156fea-194x150.jpg);"></div><div class="srvn_article_title"> Подборка шпаргалок для программистов</div></a></div><div> <a href="https://tproger.ru/digest/learn-everything-by-examples/" class="srvn_article clearfix"><div class="srvn_article_image" style="background-image: url(https://tproger2.azureedge.net/wp-content/uploads/2016/08/examples-194x150.jpg);"></div><div class="srvn_article_title"> Подборка ресурсов с примерами кода на разных языках</div></a></div><div> <a href="https://tproger.ru/news/microsoft-ai-minecraft/" class="srvn_article clearfix"><div class="srvn_article_image" style="background-image: url(https://tproger2.azureedge.net/wp-content/uploads/2016/07/1468072535-2865-1-194x150.jpg);"></div><div class="srvn_article_title"> Microsoft предлагает обучать искусственный интеллект, используя Minecraft</div></a></div><div> <a href="https://tproger.ru/news/final-features-of-cpp17/" class="srvn_article clearfix"><div class="srvn_article_image" style="background-image: url(https://tproger2.azureedge.net/wp-content/uploads/2016/07/cpp17-194x150.png);"></div><div class="srvn_article_title"> Опубликован финальный список нововведений нового стандарта С++17</div></a></div></div><div id="comments" class="comments-area comments-area-facebook"><div id="vk_comments" style="height: 270.8px; width: 100%; background: none;"><iframe name="fXD86bd3" frameborder="0" src="./Трассировщик лучей на визитке _ Типичный программист_files/widget_comments.html" width="100%" height="133" scrolling="no" id="vkwidget3" style="overflow: hidden; height: 270.8px;"></iframe></div><script type="text/rocketscript" data-rocketoptimized="true">VK.Widgets.Comments("vk_comments",{limit:10,width:"0",attach:false},7674);</script></div></div> <aside id="side-bar" class="span4 widget-area"><div id="bl_google_ads-4" class="box bl_google_ads"> <article style="text-align: center;" class=""> <ins id="google-ads-2" class="adsbygoogle" data-betweenposts="false" data-ad-client="ca-pub-9189593931769509" data-ad-slot="7838706674" data-ad-format="auto"></ins> </article></div><div class="box widget_tag_cloud" data-role="widget_get_new_quote"><div class="citation"><div class="citation-quote citation-quote-left"><i class="icon-quote-left"></i></div><div class="citation-widget"><p data-role="widget_quote_text">Ну вот допустим, у тебя есть $1000. Давай для определенности округлим до $1024...</p></div><div class="citation-quote citation-quote-right"><i class="icon-quote-right"></i></div><div class="quote_refresh_block"><img data-role="widget_get_new_quote" width="60" height="60" src="./Трассировщик лучей на визитке _ Типичный программист_files/refresh.png" alt=""></div></div></div><div id="bl_tabs-2" class="box bl_tabs"><h3 class="widget-head">Ответы экспертов</h3><ul class="nav nav-tabs" id="bl_side_tabs"><li class="active"><a href="https://tproger.ru/translations/business-card-raytracer/#bl_side_posts">Записи</a></li></ul><div class="tab-content"><div class="tab-pane active" id="bl_side_posts"><ul><li style="right: 0px;"> <a class="tab_attachment" href="https://tproger.ru/experts/20/"><img width="80" height="80" src="./Трассировщик лучей на визитке _ Типичный программист_files/Being-Too-Complicated-150x150.jpg"></a><div class="tab_text"><h5><a href="https://tproger.ru/experts/20/">Заняться теорией и олимпиадами или пойти на работу в IT-компанию? — Эксперты дают советы начинающим программистам</a><small> <time class="entry-date" datetime="2016-09-16T00:20:50+00:00">16 сентября 2016</time></small></h5></div></li><li style="right: 0px;"> <a class="tab_attachment" href="https://tproger.ru/experts/19/"><img width="80" height="80" src="./Трассировщик лучей на визитке _ Типичный программист_files/heart-programming-150x150.png"></a><div class="tab_text"><h5><a href="https://tproger.ru/experts/19/">Как лучше действовать, если вы хотите научиться программировать, но не знаете, как встать на истинный путь — готовые инструкции для начинающих от экспертов Tproger</a><small> <time class="entry-date" datetime="2016-07-11T19:15:15+00:00">11 июля 2016</time></small></h5></div></li><li style="right: 0px;"> <a class="tab_attachment" href="https://tproger.ru/experts/18/"><img width="80" height="80" src="./Трассировщик лучей на визитке _ Типичный программист_files/mobile_device-150x150.png"></a><div class="tab_text"><h5><a href="https://tproger.ru/experts/18/">С какой платформы лучше начинать мобильную разработку? Обязательно ли сразу выпускаться под все платформы?</a><small> <time class="entry-date" datetime="2016-06-01T16:01:21+00:00">1 июня 2016</time></small></h5></div></li><li style="right: 0px;"> <a class="tab_attachment" href="https://tproger.ru/experts/17/"><img width="80" height="80" src="./Трассировщик лучей на визитке _ Типичный программист_files/diploma-150x150.png"></a><div class="tab_text"><h5><a href="https://tproger.ru/experts/17/">Как в IT-компаниях смотрят на программистов без диплома при приёме на работу?</a><small> <time class="entry-date" datetime="2016-05-11T19:49:07+00:00">11 мая 2016</time></small></h5></div></li><li style="right: 0px;"> <a class="tab_attachment" href="https://tproger.ru/experts/16/"><img width="80" height="80" src="./Трассировщик лучей на визитке _ Типичный программист_files/first_lang-150x150.jpg"></a><div class="tab_text"><h5><a href="https://tproger.ru/experts/16/">Какой язык программирования лучше выбрать первым для изучения новичку?</a><small> <time class="entry-date" datetime="2016-03-29T16:23:34+00:00">29 марта 2016</time></small></h5></div></li></ul></div></div><script type="text/rocketscript" data-rocketoptimized="true">jQuery(function(){jQuery('#bl_side_tabs a').click(function(e){e.preventDefault();jQuery('.bl_tabs .tab-content ul li').css('right','-110%');jQuery(this).tab('show');jQuery(jQuery(this).attr('href')).find('li').each(function(i){jQuery(this).delay(50*i).animate({right:'0'},150,'swing');});});setTimeout(function(){jQuery('.bl_tabs .tab-content .active ul li').each(function(i){jQuery(this).delay(50*i).animate({right:'0'},150,'swing');});},500)});</script></div><div id="bl_google_ads-5" class="box bl_google_ads"> <article style="text-align: center;" class=""> <ins id="google-ads-3" class="adsbygoogle" data-betweenposts="false" data-ad-client="ca-pub-9189593931769509" data-ad-slot="6934023073" data-ad-format="auto"></ins> </article></div><div id="tag_cloud-3" class="box widget_tag_cloud"><h3 class="widget-head">Рубрики</h3><div class="tagcloud"><a href="https://tproger.ru/category/video/" class="tag-link-196 tag-link-position-1" title="7 записей" style="font-size: 10.954773869347pt;">Видео</a> <a href="https://tproger.ru/category/quiz/" class="tag-link-197 tag-link-position-2" title="10 записей" style="font-size: 11.939698492462pt;">Викторины</a> <a href="https://tproger.ru/category/weekly/" class="tag-link-140 tag-link-position-3" title="13 записей" style="font-size: 12.713567839196pt;">Еженедельная подборка</a> <a href="https://tproger.ru/category/problems/" class="tag-link-10 tag-link-position-4" title="109 записей" style="font-size: 18.974874371859pt;">Задачки</a> <a href="https://tproger.ru/category/tools/" class="tag-link-185 tag-link-position-5" title="9 записей" style="font-size: 11.658291457286pt;">Инструменты</a> <a href="https://tproger.ru/category/interview/" class="tag-link-49 tag-link-position-6" title="12 записей" style="font-size: 12.43216080402pt;">Интервью</a> <a href="https://tproger.ru/category/links/" class="tag-link-127 tag-link-position-7" title="40 записей" style="font-size: 15.949748743719pt;">Интересные ссылки</a> <a href="https://tproger.ru/category/looking-for-programmer/" class="tag-link-203 tag-link-position-8" title="2 записи" style="font-size: 8pt;">Ищем программиста</a> <a href="https://tproger.ru/category/books/" class="tag-link-169 tag-link-position-9" title="20 записей" style="font-size: 13.909547738693pt;">Книги</a> <a href="https://tproger.ru/category/news/" class="tag-link-126 tag-link-position-10" title="297 записей" style="font-size: 22pt;">Новости</a> <a href="https://tproger.ru/category/experts/" class="tag-link-91 tag-link-position-11" title="20 записей" style="font-size: 13.909547738693pt;">Ответы экспертов</a> <a href="https://tproger.ru/category/translations/" class="tag-link-3 tag-link-position-12" title="199 записей" style="font-size: 20.804020100503pt;">Переводы</a> <a href="https://tproger.ru/category/digest/" class="tag-link-133 tag-link-position-13" title="68 записей" style="font-size: 17.56783919598pt;">Подборки</a> <a href="https://tproger.ru/category/projects/" class="tag-link-20 tag-link-position-14" title="21 запись" style="font-size: 14.050251256281pt;">Рассказы о своих проектах</a> <a href="https://tproger.ru/category/events/" class="tag-link-106 tag-link-position-15" title="21 запись" style="font-size: 14.050251256281pt;">События</a> <a href="https://tproger.ru/category/sponsored/" class="tag-link-244 tag-link-position-16" title="7 записей" style="font-size: 10.954773869347pt;">Спонсорское</a> <a href="https://tproger.ru/category/articles/" class="tag-link-1 tag-link-position-17" title="145 записей" style="font-size: 19.819095477387pt;">Статьи</a></div></div><div id="bl_html-21" class="box box bl_html"><div class="widget-body"><i style="float: left;" class="sprite sprite-im"></i><h4 style="position: relative; left: 15px; padding-bottom: 15px;padding-right:15px;">Уведомления о свежих постах (Chrome, Firefox, Android, Telegram).</h4> <a href="https://pushall.ru/tproger" class="btn bluth  btn- btn-block" target="_self">Подписаться</a></div></div><div id="bl_html-5" class="box nopadding box bl_html"><div class="widget-body"><script name="goodboy" data-rocketsrc="//vk.com/js/api/openapi.js?123" type="text/rocketscript" data-rocketoptimized="true"></script><div class="vk_group" id="vk_groups" style="width: 370px; height: 202.4px; background: none;"><iframe name="fXD19c58" frameborder="0" src="./Трассировщик лучей на визитке _ Типичный программист_files/widget_community.html" width="370" height="182" scrolling="no" id="vkwidget4" style="overflow: hidden; height: 202.4px;"></iframe></div><script type="text/rocketscript" data-rocketoptimized="true">VK.Widgets.Group("vk_groups",{mode:3,redesign:1,width:"auto",height:"auto",color1:'FFFFFF',color2:'04a49c',color3:'757575'},30666517);console.log('What does the fox say?');console.log('Ahee aheee aheee');</script></div></div><div id="tag_cloud-2" class="box widget_tag_cloud"><h3 class="widget-head">Темы</h3><div class="tagcloud"><a href="https://tproger.ru/tag/android/" class="tag-link-70 tag-link-position-1" title="26 записей" style="font-size: 15.148936170213pt;">Android</a> <a href="https://tproger.ru/tag/c-sharp/" class="tag-link-95 tag-link-position-2" title="27 записей" style="font-size: 15.446808510638pt;">C#</a> <a href="https://tproger.ru/tag/cpp/" class="tag-link-35 tag-link-position-3" title="37 записей" style="font-size: 17.382978723404pt;">C++</a> <a href="https://tproger.ru/tag/git/" class="tag-link-79 tag-link-position-4" title="16 записей" style="font-size: 12.170212765957pt;">Git</a> <a href="https://tproger.ru/tag/google/" class="tag-link-148 tag-link-position-5" title="27 записей" style="font-size: 15.446808510638pt;">Google</a> <a href="https://tproger.ru/tag/hardware/" class="tag-link-83 tag-link-position-6" title="26 записей" style="font-size: 15.148936170213pt;">Hardware</a> <a href="https://tproger.ru/tag/java/" class="tag-link-26 tag-link-position-7" title="41 запись" style="font-size: 17.978723404255pt;">Java</a> <a href="https://tproger.ru/tag/javascript/" class="tag-link-25 tag-link-position-8" title="48 записей" style="font-size: 19.021276595745pt;">JavaScript</a> <a href="https://tproger.ru/tag/linux/" class="tag-link-50 tag-link-position-9" title="28 записей" style="font-size: 15.595744680851pt;">Linux</a> <a href="https://tproger.ru/tag/microsoft/" class="tag-link-206 tag-link-position-10" title="18 записей" style="font-size: 12.914893617021pt;">Microsoft</a> <a href="https://tproger.ru/tag/opensource/" class="tag-link-51 tag-link-position-11" title="36 записей" style="font-size: 17.234042553191pt;">OpenSource</a> <a href="https://tproger.ru/tag/php/" class="tag-link-152 tag-link-position-12" title="15 записей" style="font-size: 11.723404255319pt;">PHP</a> <a href="https://tproger.ru/tag/python/" class="tag-link-107 tag-link-position-13" title="35 записей" style="font-size: 17.085106382979pt;">Python</a> <a href="https://tproger.ru/tag/stackoverflow/" class="tag-link-78 tag-link-position-14" title="9 записей" style="font-size: 8.7446808510638pt;">StackOverflow</a> <a href="https://tproger.ru/tag/unity/" class="tag-link-102 tag-link-position-15" title="11 записей" style="font-size: 9.936170212766pt;">Unity</a> <a href="https://tproger.ru/tag/windows/" class="tag-link-186 tag-link-position-16" title="13 записей" style="font-size: 10.978723404255pt;">Windows</a> <a href="https://tproger.ru/tag/algorithms/" class="tag-link-24 tag-link-position-17" title="33 записи" style="font-size: 16.63829787234pt;">Алгоритмы</a> <a href="https://tproger.ru/tag/security/" class="tag-link-85 tag-link-position-18" title="45 записей" style="font-size: 18.574468085106pt;">Безопасность</a> <a href="https://tproger.ru/tag/safe-code/" class="tag-link-41 tag-link-position-19" title="9 записей" style="font-size: 8.7446808510638pt;">Безопасный код</a> <a href="https://tproger.ru/tag/browsers/" class="tag-link-183 tag-link-position-20" title="18 записей" style="font-size: 12.914893617021pt;">Браузеры</a> <a href="https://tproger.ru/tag/web/" class="tag-link-54 tag-link-position-21" title="60 записей" style="font-size: 20.510638297872pt;">Веб-разработка</a> <a href="https://tproger.ru/tag/brain-teasers/" class="tag-link-38 tag-link-position-22" title="41 запись" style="font-size: 17.978723404255pt;">Головоломки</a> <a href="https://tproger.ru/tag/for-motivation/" class="tag-link-122 tag-link-position-23" title="21 запись" style="font-size: 13.808510638298pt;">Для мотивации</a> <a href="https://tproger.ru/tag/for-beginners/" class="tag-link-40 tag-link-position-24" title="77 записей" style="font-size: 22pt;">Для начинающих</a> <a href="https://tproger.ru/tag/expert-problems/" class="tag-link-58 tag-link-position-25" title="13 записей" style="font-size: 10.978723404255pt;">Задачи повышенной сложности</a> <a href="https://tproger.ru/tag/middle-problems/" class="tag-link-57 tag-link-position-26" title="11 записей" style="font-size: 9.936170212766pt;">Задачи умеренной сложности</a> <a href="https://tproger.ru/tag/tools/" class="tag-link-75 tag-link-position-27" title="44 записи" style="font-size: 18.425531914894pt;">Инструменты</a> <a href="https://tproger.ru/tag/internet/" class="tag-link-2 tag-link-position-28" title="29 записей" style="font-size: 15.893617021277pt;">Интернет</a> <a href="https://tproger.ru/tag/success-story/" class="tag-link-52 tag-link-position-29" title="12 записей" style="font-size: 10.382978723404pt;">История успеха</a> <a href="https://tproger.ru/tag/best-practice/" class="tag-link-62 tag-link-position-30" title="44 записи" style="font-size: 18.425531914894pt;">Лучшая практика</a> <a href="https://tproger.ru/tag/math-and-probability/" class="tag-link-39 tag-link-position-31" title="9 записей" style="font-size: 8.7446808510638pt;">Математика и теория вероятностей</a> <a href="https://tproger.ru/tag/machine-learning/" class="tag-link-143 tag-link-position-32" title="17 записей" style="font-size: 12.617021276596pt;">Машинное обучение</a> <a href="https://tproger.ru/tag/mobiledev/" class="tag-link-71 tag-link-position-33" title="25 записей" style="font-size: 14.851063829787pt;">Мобильная разработка</a> <a href="https://tproger.ru/tag/neural-network/" class="tag-link-160 tag-link-position-34" title="16 записей" style="font-size: 12.170212765957pt;">Нейронные сети</a> <a href="https://tproger.ru/tag/low-level-coding/" class="tag-link-45 tag-link-position-35" title="14 записей" style="font-size: 11.425531914894pt;">Низкоуровневое программирование</a> <a href="https://tproger.ru/tag/learn-programming/" class="tag-link-65 tag-link-position-36" title="58 записей" style="font-size: 20.212765957447pt;">Обучение программированию</a> <a href="https://tproger.ru/tag/optimization/" class="tag-link-67 tag-link-position-37" title="16 записей" style="font-size: 12.170212765957pt;">Оптимизация</a> <a href="https://tproger.ru/tag/threads-and-locks/" class="tag-link-36 tag-link-position-38" title="8 записей" style="font-size: 8pt;">Потоки и блокировки</a> <a href="https://tproger.ru/tag/gamedev/" class="tag-link-68 tag-link-position-39" title="51 запись" style="font-size: 19.468085106383pt;">Разработка игр</a> <a href="https://tproger.ru/tag/featured/" class="tag-link-147 tag-link-position-40" title="16 записей" style="font-size: 12.170212765957pt;">Рекомендуем</a> <a href="https://tproger.ru/tag/retro/" class="tag-link-48 tag-link-position-41" title="20 записей" style="font-size: 13.510638297872pt;">Ретро</a> <a href="https://tproger.ru/tag/job-interview/" class="tag-link-258 tag-link-position-42" title="13 записей" style="font-size: 10.978723404255pt;">Собеседование</a> <a href="https://tproger.ru/tag/testing/" class="tag-link-34 tag-link-position-43" title="9 записей" style="font-size: 8.7446808510638pt;">Тестирование</a> <a href="https://tproger.ru/tag/c-language/" class="tag-link-259 tag-link-position-44" title="16 записей" style="font-size: 12.170212765957pt;">Язык Си</a> <a href="https://tproger.ru/tag/programming-languages/" class="tag-link-56 tag-link-position-45" title="31 запись" style="font-size: 16.340425531915pt;">Языки программирования</a></div></div><div id="bl_google_ads-6" class="box bl_google_ads"> <article style="text-align: center;" class=""> <ins id="google-ads-4" class="adsbygoogle" data-betweenposts="false" data-ad-client="ca-pub-9189593931769509" data-ad-slot="9887489474" data-ad-format="auto"></ins> </article></div> </aside></div></div> <footer id="colophon" class="site-footer" role="contentinfo"><div class="container"><div class="row-fluid" id="footer-body"><div id="text-2" class="span4 widget_text"><div class="textwidget"><div style="padding-top:4px"><a class="footer_a" href="https://tproger.ru/about">О проекте</a><a class="footer_a" href="https://tproger.ru/ad">Реклама</a><a class="footer_a" href="mailto:admin@tproger.ru">admin@tproger.ru</a></div></div></div><div id="text-3" class="span4 widget_text"><div class="textwidget"><a href="http://vk.com/tproger"><i class="social_b sprite sprite-vk"></i></a> <a href="https://www.facebook.com/tproger/"><i class="social_b sprite sprite-fb"></i></a> <a href="https://twitter.com/tproger"><i class="social_b sprite sprite-tw"></i></a> <a href="https://telegram.me/tproger_official"><i class="social_b sprite sprite-tm"></i></a> <a href="https://tproger.ru/rss"><i class="social_b sprite sprite-rs"></i></a></div></div><div id="text-4" class="span4 widget_text"><div class="textwidget"><span style=" opacity: .2; color:#fff;"> Нашли опечатку? Выделите фрагмент и отправьте нажатием Ctrl+Enter. </span></div></div></div></div> </footer></div><div style="background-color: rgba(0, 0, 0, 0);" class="tproger-elevator-block" id="tproger-elevator"><div class="elevator-arrow"> <i id="tproger-arrow" class="sprite sprite-arrow"></i> <br> <i style="display:none;" class="sprite sprite-elevator" id="tproger-elevator-icon"></i></div></div> <script type="text/rocketscript" data-rocketoptimized="true">(function(d,w,c){(w[c]=w[c]||[]).push(function(){try{w.yaCounter27485085=new Ya.Metrika({id:27485085,webvisor:true,clickmap:true,trackLinks:true,accurateTrackBounce:true});}catch(e){}});var n=d.getElementsByTagName("script")[0],s=d.createElement("script"),f=function(){n.parentNode.insertBefore(s,n);};s.type="text/javascript";s.async=true;s.src=(d.location.protocol=="https:"?"https:":"http:")+"//mc.yandex.ru/metrika/watch.js";if(w.opera=="[object Opera]"){d.addEventListener("DOMContentLoaded",f,false);}else{f();}})(document,window,"yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img
src="//mc.yandex.ru/watch/27485085" style="position:absolute; left:-9999px;" alt="" /&gt;&lt;/div&gt;</noscript><script type="text/rocketscript" data-rocketoptimized="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-78195897-1','auto');ga('send','pageview');</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/tproger-elevator/assets/js/elevator.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var tprogerElevator={"pluginsUrl":"https:\/\/tproger.ru\/wp-content\/plugins"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/tproger-elevator/assets/js/tproger-elevator.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/tproger-mistape/assets/js/modernizr.custom.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var mistape_args={"ajaxurl":"https:\/\/tproger.ru\/wp-admin\/admin-ajax.php","nonce":"f368205089"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/tproger-mistape/assets/js/mistape-front.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/tproger-save-target-blank/TargetBlanker.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var pollsL10n={"ajax_url":"https:\/\/tproger.ru\/wp-admin\/admin-ajax.php","text_wait":"\u0412\u0430\u0448 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0437\u0430\u043f\u0440\u043e\u0441 \u0435\u0449\u0435 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 ...","text_valid":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0442\u0432\u0435\u0442.","text_multiple":"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432:","show_loading":"1","show_fading":"1"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/wp-polls/polls-js.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/jquery.snippet.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/jquery.nivo.slider.pack.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/jquery.timeago.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/bootstrap.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/jquery.magnific-popup.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var blu={"site_url":"https:\/\/tproger.ru","ajaxurl":"https:\/\/tproger.ru\/wp-admin\/admin-ajax.php","locale":{"no_search_results":"No results match your search.","searching":"Searching...","search_results":"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430","see_all":"see all","loading":"Loading...","no_more_posts":"No more posts","see_more_articles":"See more articles","no_email_provided":"No email provided","thank_you_for_subscribing":"Thank you for subscribing!"}};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/theme.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/plugins.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/themes/bliss/assets/js/retina.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-includes/js/comment-reply.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-includes/js/wp-embed.min.js?v=18" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">var CrayonSyntaxSettings={"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/tproger.ru\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};var CrayonSyntaxStrings={"copy":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 %s \u0434\u043b\u044f \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, %s \u0434\u043b\u044f \u0432\u0441\u0442\u0430\u0432\u043a\u0438","minimize":"Click To Expand Code"};</script><script type="text/rocketscript" data-rocketsrc="https://tproger2.azureedge.net/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?v=18" data-rocketoptimized="true"></script><div class="mistape_mod_notification"><div class="tms_icon"> <span class="dashicons dashicons-heart"></span></div>Спасибо за внимательность.<br>Опечатка уже отправлена нашим редакторам.</div><script type="text/rocketscript" data-rocketoptimized="true">var mistape_slack_hook="Когда-то тут был hook для отправки репорта нам в Slack, но он испугался злых хацкеров и убежал в лес";</script><div id="mistape_dialog" data-mode="notify"><div class="dialog__overlay"></div><div class="dialog__content"><div id="mistape_success_dialog" class="mistape_dialog_screen"><h2>Спасибо!</h2><h3>Теперь редакторы в курсе.</h3><div class="mistape_dialog_block"> <a class="mistape_action" data-dialog-close="" role="button">Закрыть</a></div></div></div></div><ins class="adsbygoogle" data-adsbygoogle-status="done" style="display: none; width: auto; height: auto;"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent"><iframe width="0" height="0" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" src="./Трассировщик лучей на визитке _ Типичный программист_files/saved_resource.html"></iframe></ins></ins></ins><div id="onesignal-bell-container" class="onesignal-bell-container onesignal-reset onesignal-bell-container-bottom-right"><div id="onesignal-bell-launcher" class="onesignal-bell-launcher onesignal-bell-launcher-inactive onesignal-bell-launcher-sm onesignal-bell-launcher-bottom-right onesignal-bell-launcher-theme-inverse onesignal-bell-launcher-active"><div class="onesignal-bell-launcher-button"><!--?xml version="1.0" encoding="utf-8"?-->
<!-- Generator: Adobe Illustrator 19.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" class="onesignal-bell-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="99.7px" height="99.7px" viewBox="0 0 99.7 99.7" style="filter: drop-shadow(0 2px 4px rgba(34,36,38,0.35));; -webkit-filter: drop-shadow(0 2px 4px rgba(34,36,38,0.35));;" xml:space="preserve">
<g>
	<circle class="background" cx="49.9" cy="49.9" r="49.9" style="fill: white;"></circle>
	<g id="Layer_2">
		<g>
			<path class="foreground" d="M50.1,66.2H27.7c0,0-2-0.2-2-2.1c0-1.9,1.7-2,1.7-2s6.7-3.2,6.7-5.5c0-2.3-1.1-3.9-1.1-13.3
				s6-16.6,13.2-16.6c0,0,1-2.4,3.9-2.4c2.8,0,3.8,2.4,3.8,2.4c7.2,0,13.2,7.2,13.2,16.6s-1,11-1,13.3c0,2.3,6.7,5.5,6.7,5.5
				s1.7,0.1,1.7,2c0,1.8-2.1,2.1-2.1,2.1H50.1z" style="fill: rgb(10, 153, 147);"></path>
			<path class="foreground" d="M42.9,68.5h14.5c0,0-1,6.3-7.2,6.3S42.9,68.5,42.9,68.5z" style="fill: rgb(10, 153, 147);"></path>
			<ellipse class="stroke" cx="49.9" cy="49.9" rx="37.4" ry="36.9" style="stroke: rgb(10, 153, 147);"></ellipse>
		</g>
	</g>
</g>
</svg>
</div><div class="onesignal-bell-launcher-badge" style="filter: drop-shadow(0 2px 4px rgba(34,36,38,0));; -webkit-filter: drop-shadow(0 2px 4px rgba(34,36,38,0));;"></div><div class="onesignal-bell-launcher-message"><div class="onesignal-bell-launcher-message-body"></div></div><div class="onesignal-bell-launcher-dialog" style="filter: drop-shadow(0px 2px 2px rgba(34,36,38,.15));; -webkit-filter: drop-shadow(0px 2px 2px rgba(34,36,38,.15));;"><div class="onesignal-bell-launcher-dialog-body"></div></div></div></div></body></html>